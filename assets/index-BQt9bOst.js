(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const u of e.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function a(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(n){if(n.ep)return;n.ep=!0;const e=a(n);fetch(n.href,e)}})();async function M(t,o=3,a=1e3){for(let i=0;i<o;i++)try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP ${n.status}`);return n}catch(n){if(i===o-1)throw n;await new Promise(e=>setTimeout(e,a*2**i))}throw new Error("Unreachable")}async function Ut(t,o,a,i){if(!o||!a||!t||!i)throw new Error("API key, base URL, station URI, and railway URI are required");const n=(()=>{const s=new Date().getDay();return s>=1&&s<=5?"odpt.Calendar:Weekday":"odpt.Calendar:SaturdayHoliday"})(),e=new URLSearchParams({"acl:consumerKey":String(o),"odpt:railway":i,"odpt:station":t,"odpt:calendar":n}),u=`${a}odpt:StationTimetable?${e.toString()}`;return await(await M(u)).json()}async function at(t,o,a){if(!t||!o||!a)throw new Error("API key, base URL, and railway URI are required");const i=new URLSearchParams({"acl:consumerKey":String(t),"odpt:railway":a}),n=`${o}odpt:TrainInformation?${i.toString()}`;return await(await M(n)).json()}async function vt(t,o,a){if(!o||!a)throw new Error("API key and base URL are required");if(t.length===0)return[];const i=new URLSearchParams({"acl:consumerKey":String(o)});i.append("owl:sameAs",t.join(","));const n=`${a}odpt:Station?${i.toString()}`;return await(await M(n)).json()}async function _t(t,o){if(!t||!o)throw new Error("API key and base URL are required");const a=new URLSearchParams({"acl:consumerKey":String(t)}),i=`${o}odpt:Railway?${a.toString()}`;return await(await M(i)).json()}async function Ht(t,o,a){if(!o||!a||!t)throw new Error("API key, base URL, and railway URI are required");const i=new URLSearchParams({"acl:consumerKey":String(o)});i.append("owl:sameAs",t);const n=`${a}odpt:Railway?${i.toString()}`,u=await(await M(n)).json();return u.length>0?u[0]:null}async function Bt(t,o){if(!t||!o)throw new Error("API key and base URL are required");const a=new URLSearchParams({"acl:consumerKey":String(t)}),i=`${o}odpt:RailDirection?${a.toString()}`;return await(await M(i)).json()}async function Yt(t,o){if(!t||!o)throw new Error("API key and base URL are required");const a=new URLSearchParams({"acl:consumerKey":String(t)}),i=`${o}odpt:TrainType?${a.toString()}`;return await(await M(i)).json()}function C(t){if(!t)return"N/A";if(typeof t=="string")return t;const o=t;return o.ja||o.en||"N/A"}function kt(t){const[o,a]=t.split(":").map(i=>Number(i));return o*60+a}function st(t,o,a,i=5){return(t.find(u=>u["odpt:railDirection"]===o)?.["odpt:stationTimetableObject"]??[]).filter(u=>typeof u["odpt:departureTime"]=="string").filter(u=>kt(u["odpt:departureTime"])>=a).slice(0,i)}function Dt(...t){const o=new Set;for(const a of t)for(const i of a??[]){const n=i["odpt:destinationStation"];if(n)if(Array.isArray(n)){for(const e of n)if(e){if(typeof e=="string")o.add(e);else if(typeof e=="object"){const u=e["owl:sameAs"]||e["@id"]||e.id;u&&typeof u=="string"&&o.add(u)}}}else typeof n=="string"&&o.add(n)}return o}function ft(t=new Date){return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}function ht(t){return document.getElementById(t)}class Pt{constructor(o=500,a,i){if(this.maxEntries=o,this.ttlMs=a,this.persistKeyName=i,this.map=new Map,i&&typeof localStorage<"u")try{const n=localStorage.getItem(i);if(n){const e=JSON.parse(n);for(const u of Object.keys(e)){const d=e[u];(!d.expires||d.expires>Date.now())&&this.map.set(u,d)}}}catch(n){console.warn(`Failed to restore cache from localStorage key "${i}":`,n)}}get(o){const a=this.map.get(o);if(a){if(a.expires&&a.expires<=Date.now()){this.map.delete(o);return}return this.map.delete(o),this.map.set(o,a),a.v}}set(o,a){const i=this.ttlMs?Date.now()+this.ttlMs:void 0;for(this.map.has(o)&&this.map.delete(o),this.map.set(o,{v:a,expires:i});this.map.size>this.maxEntries;){const n=this.map.keys().next().value;this.map.delete(n)}this.persistKeyName&&this.persist()}has(o){return typeof this.get(o)<"u"}persist(){if(this.persistKeyName)try{const o={};for(const[a,i]of this.map.entries())o[a]=i;localStorage.setItem(this.persistKeyName,JSON.stringify(o))}catch(o){console.warn(`Failed to persist cache to localStorage key "${this.persistKeyName}":`,o)}}keys(){return Array.from(this.map.keys())}enablePersistence(o){this.persistKeyName=o,this.persist()}}const Et={"odpt.TrainType:Sotetsu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Sotetsu.CommuterLimitedExpress":{outline:"black",text:"red",fill:"white"},"odpt.TrainType:Sotetsu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Sotetsu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Sotetsu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Sotetsu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Odakyu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Odakyu.CommuterSemiExpress":{outline:"black",text:"yellow",fill:"black"},"odpt.TrainType:Odakyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Odakyu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Odakyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Odakyu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Odakyu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Keikyu.AccessExpress":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.AirportRapidLimitedExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Keikyu.CommuterLimitedExpress":{outline:"black",text:"red",fill:"white"},"odpt.TrainType:Keikyu.EveningWing":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Keikyu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Keikyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Keikyu.MorningWing":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.RapidLimitedExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Keikyu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Seibu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Seibu.CommuterSemiExpress":{outline:"black",text:"yellow",fill:"black"},"odpt.TrainType:Seibu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Seibu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.HaijimaLiner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Seibu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Seibu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Seibu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Seibu.S-TRAIN":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tokyu.CommuterLimitedExpress":{outline:"yellow",text:"red",fill:"white"},"odpt.TrainType:Tokyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tokyu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.LimitedExpress":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Tokyu.S-TRAIN":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tobu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.KawagoeLimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Tobu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Tobu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Tobu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Tobu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Tobu.SL-Taiju":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.SectionExpress":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tobu.SectionSemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.TH-LINER":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.TJ-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:JR-East.ChuoSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.CommuterRapid":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:JR-East.CommuterSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:JR-East.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:JR-East.Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:JR-East.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:JR-East.OmeSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:JR-East.SpecialRapid":{outline:"black",text:"yellow",fill:"red"}};function jt(){if(document.getElementById("train-type-dynamic-styles"))return;const t=document.createElement("style");t.id="train-type-dynamic-styles";let o="";for(const[a,i]of Object.entries(Et)){const n=St(a);o+=`
.${n} {
  background-color: ${i.fill};
  color: ${i.text};
  border: 2px solid ${i.outline};
}
`}t.textContent=o,document.head.appendChild(t)}function St(t){return"train-type-"+t.replace(/[:.]/g,"-")}function $t(t){return t in Et?St(t):"type-LOC"}const zt={"odpt.Railway:Odakyu.Odawara":{inbound:"新宿",outbound:"小田原"},"odpt.Railway:Keikyu.Main":{inbound:"品川",outbound:"浦賀"},"odpt.Railway:Tobu.Nikko":{inbound:"浅草",outbound:"東武日光"},"odpt.Railway:Tobu.TobuSkytree":{inbound:"浅草",outbound:"東武動物公園"},"odpt.Railway:JR-East.ChuoSobuLocal":{inbound:"三鷹",outbound:"千葉"},"odpt.Railway:Fujikyu.Fujikyu":{inbound:"大月",outbound:"河口湖"},"odpt.Railway:Keikyu.Airport":{inbound:"品川",outbound:"羽田空港"},"odpt.Railway:Keikyu.Daishi":{inbound:"京急川崎",outbound:"小島新田"},"odpt.Railway:Tokyu.DenEnToshi":{inbound:"渋谷",outbound:"中央林間"},"odpt.Railway:Tokyu.Ikegami":{inbound:"五反田",outbound:"蒲田"},"odpt.Railway:Tobu.Daishi":{inbound:"西新井",outbound:"大師前"},"odpt.Railway:Tobu.Isesaki":{inbound:"東武動物公園",outbound:"伊勢崎"},"odpt.Railway:Tobu.Kiryu":{inbound:"太田",outbound:"赤城"},"odpt.Railway:ChibaMonorail.Line2":{inbound:"千葉",outbound:"千城台"},"odpt.Railway:JR-East.Chuo":{inbound:"東京",outbound:"高尾"},"odpt.Railway:JR-East.Joban":{inbound:"上野",outbound:"水戸"},"odpt.Railway:Seibu.Toshima":{inbound:"練馬",outbound:"豊島園"},"odpt.Railway:Sotetsu.Izumino":{inbound:"二俣川",outbound:"湘南台"},"odpt.Railway:Sotetsu.Main":{inbound:"横浜",outbound:"海老名"},"odpt.Railway:Sotetsu.SotetsuShinYokohama":{inbound:"新横浜",outbound:"西谷"},"odpt.Railway:JR-Central.TokaidoShinkansen":{inbound:"東京",outbound:"新大阪"},"odpt.Railway:Odakyu.Enoshima":{inbound:"相模大野",outbound:"片瀬江ノ島"},"odpt.Railway:Odakyu.Tama":{inbound:"新百合ヶ丘",outbound:"唐木田"},"odpt.Railway:Keikyu.Kurihama":{inbound:"堀ノ内",outbound:"三崎口"},"odpt.Railway:Tokyu.Setagaya":{inbound:"三軒茶屋",outbound:"下高井戸"},"odpt.Railway:Keikyu.Zushi":{inbound:"金沢八景",outbound:"逗子・葉山"},"odpt.Railway:Seibu.Haijima":{inbound:"西武新宿",outbound:"拝島"},"odpt.Railway:Seibu.Ikebukuro":{inbound:"池袋",outbound:"飯能"},"odpt.Railway:Chichibu.Chichibu":{inbound:"羽生",outbound:"三峰口"},"odpt.Railway:Seibu.Kokubunji":{inbound:"国分寺",outbound:"東村山"},"odpt.Railway:Seibu.Sayama":{inbound:"西所沢",outbound:"西武球場前"},"odpt.Railway:Isumi.Isumi":{inbound:"大原",outbound:"上総中野"},"odpt.Railway:Seibu.SeibuChichibu":{inbound:"吾野",outbound:"西武秩父"},"odpt.Railway:Seibu.SeibuYurakucho":{inbound:"練馬",outbound:"小竹向原"},"odpt.Railway:Seibu.Seibuen":{inbound:"東村山",outbound:"西武園"},"odpt.Railway:Seibu.Shinjuku":{inbound:"西武新宿",outbound:"本川越"},"odpt.Railway:Seibu.Tamagawa":{inbound:"武蔵境",outbound:"是政"},"odpt.Railway:Seibu.Tamako":{inbound:"国分寺",outbound:"西武遊園地"},"odpt.Railway:Seibu.Yamaguchi":{inbound:"西武球場前",outbound:"西武遊園地"},"odpt.Railway:Tokyu.Kodomonokuni":{inbound:"長津田",outbound:"こどもの国"},"odpt.Railway:Tokyu.Meguro":{inbound:"目黒",outbound:"日吉"},"odpt.Railway:Tokyu.Oimachi":{inbound:"大井町",outbound:"溝の口"},"odpt.Railway:Tokyu.TokyuShinYokohama":{inbound:"新横浜",outbound:"西谷"},"odpt.Railway:JR-Central.Gotemba":{inbound:"国府津",outbound:"沼津"},"odpt.Railway:JR-Central.Minobu":{inbound:"富士",outbound:"甲府"},"odpt.Railway:Tokyu.TokyuTamagawa":{inbound:"多摩川",outbound:"蒲田"},"odpt.Railway:Choshi.Choshi":{inbound:"銚子",outbound:"外川"},"odpt.Railway:Tokyu.Toyoko":{inbound:"渋谷",outbound:"横浜"},"odpt.Railway:Tobu.Kameido":{inbound:"曳舟",outbound:"亀戸"},"odpt.Railway:Tobu.Kinugawa":{inbound:"下今市",outbound:"新藤原"},"odpt.Railway:IzuHakone.Sunzu":{inbound:"三島",outbound:"修善寺"},"odpt.Railway:Tobu.KoizumiBranch":{inbound:"館林",outbound:"西小泉"},"odpt.Railway:Tobu.Koizumi":{inbound:"太田",outbound:"西小泉"},"odpt.Railway:Enoden.Enoden":{inbound:"鎌倉",outbound:"藤沢"},"odpt.Railway:Tobu.Ogose":{inbound:"坂戸",outbound:"越生"},"odpt.Railway:Tobu.Sano":{inbound:"館林",outbound:"葛生"},"odpt.Railway:Izukyu.Izukyu":{inbound:"伊東",outbound:"伊豆急下田"},"odpt.Railway:JR-Central.Chuo":{inbound:"名古屋",outbound:"中津川"},"odpt.Railway:Tobu.TobuSkytreeBranch":{inbound:"曳舟",outbound:"亀戸"},"odpt.Railway:Tobu.TobuUrbanPark":{inbound:"大宮",outbound:"船橋"},"odpt.Railway:Tobu.Tojo":{inbound:"池袋",outbound:"寄居"},"odpt.Railway:Tobu.Utsunomiya":{inbound:"新栃木",outbound:"東武宇都宮"},"odpt.Railway:Aizu.Aizu":{inbound:"西若松",outbound:"会津高原"},"odpt.Railway:ChibaMonorail.Line1":{inbound:"千葉みなと",outbound:"県庁前"},"odpt.Railway:Hitachinaka.Minato":{inbound:"勝田",outbound:"阿字ヶ浦"},"odpt.Railway:Hokuetsu.Hokuhoku":{inbound:"六日町",outbound:"犀潟"},"odpt.Railway:Hokuso.Hokuso":{inbound:"京成高砂",outbound:"印旛日本医大"},"odpt.Railway:IzuHakone.Daiyuzan":{inbound:"小田原",outbound:"大雄山"},"odpt.Railway:JR-Central.Tokaido":{inbound:"東京",outbound:"熱海"},"odpt.Railway:JR-East.AkitaShinkansen":{inbound:"東京",outbound:"秋田"},"odpt.Railway:JR-East.Aterazawa":{inbound:"山形",outbound:"左沢"},"odpt.Railway:JR-East.BanetsuEast":{inbound:"郡山",outbound:"いわき"},"odpt.Railway:JR-East.BanetsuWest":{inbound:"郡山",outbound:"新潟"},"odpt.Railway:JR-East.Kitakami":{inbound:"北上",outbound:"横手"},"odpt.Railway:JR-East.ChuoTatsunoBranch":{inbound:"岡谷",outbound:"辰野"},"odpt.Railway:JR-East.Echigo":{inbound:"新潟",outbound:"柏崎"},"odpt.Railway:JR-East.Gono":{inbound:"東能代",outbound:"川部"},"odpt.Railway:JR-East.Hachinohe":{inbound:"八戸",outbound:"久慈"},"odpt.Railway:JR-East.Hakushin":{inbound:"新潟",outbound:"新発田"},"odpt.Railway:JR-East.Hanawa":{inbound:"大館",outbound:"好摩"},"odpt.Railway:JR-East.HokurikuShinkansen":{inbound:"東京",outbound:"金沢"},"odpt.Railway:JR-East.Iiyama":{inbound:"豊野",outbound:"越後川口"},"odpt.Railway:JR-East.Ishinomaki":{inbound:"小牛田",outbound:"女川"},"odpt.Railway:JR-East.JoetsuShinkansen":{inbound:"東京",outbound:"新潟"},"odpt.Railway:JR-East.Kamaishi":{inbound:"花巻",outbound:"釜石"},"odpt.Railway:JR-East.Karasuyama":{inbound:"宝積寺",outbound:"烏山"},"odpt.Railway:JR-East.Kesennuma":{inbound:"前谷地",outbound:"気仙沼"},"odpt.Railway:JR-East.Koumi":{inbound:"小淵沢",outbound:"小諸"},"odpt.Railway:JR-East.Mito":{inbound:"小山",outbound:"水戸"},"odpt.Railway:JR-East.Nikko":{inbound:"宇都宮",outbound:"日光"},"odpt.Railway:JR-East.Ofunato":{inbound:"一ノ関",outbound:"盛"},"odpt.Railway:JR-East.Oga":{inbound:"追分",outbound:"男鹿"},"odpt.Railway:JR-East.Oito":{inbound:"松本",outbound:"南小谷"},"odpt.Railway:JR-East.Ominato":{inbound:"野辺地",outbound:"大湊"},"odpt.Railway:JR-East.OuYamagata":{inbound:"福島",outbound:"新庄"},"odpt.Railway:JR-East.Ou":{inbound:"福島",outbound:"青森"},"odpt.Railway:JR-East.RikuEast":{inbound:"小牛田",outbound:"新庄"},"odpt.Railway:JR-East.RikuWest":{inbound:"新庄",outbound:"余目"},"odpt.Railway:JR-East.Ryomo":{inbound:"小山",outbound:"新前橋"},"odpt.Railway:JR-East.SensekiTohoku":{inbound:"仙台",outbound:"石巻"},"odpt.Railway:JR-East.Senseki":{inbound:"仙台",outbound:"石巻"},"odpt.Railway:JR-East.Senzan":{inbound:"仙台",outbound:"羽前千歳"},"odpt.Railway:JR-East.Shinetsu":{inbound:"高崎",outbound:"新潟"},"odpt.Railway:JR-East.Shinonoi":{inbound:"塩尻",outbound:"篠ノ井"},"odpt.Railway:JR-East.SuigunBranch":{inbound:"郡山",outbound:"水戸"},"odpt.Railway:JR-East.Suigun":{inbound:"水戸",outbound:"郡山"},"odpt.Railway:JR-East.Tadami":{inbound:"会津若松",outbound:"小出"},"odpt.Railway:JR-East.Tazawako":{inbound:"盛岡",outbound:"大曲"},"odpt.Railway:JR-East.TohokuShinkansen":{inbound:"東京",outbound:"新青森"},"odpt.Railway:JR-East.Tohoku":{inbound:"東京",outbound:"一ノ関"},"odpt.Railway:JR-East.Tsugaru":{inbound:"青森",outbound:"三厩"},"odpt.Railway:JR-East.Uetsu":{inbound:"新津",outbound:"秋田"},"odpt.Railway:JR-East.Yahiko":{inbound:"東三条",outbound:"弥彦"},"odpt.Railway:JR-East.Yamada":{inbound:"盛岡",outbound:"宮古"},"odpt.Railway:JR-East.YamagataShinkansen":{inbound:"東京",outbound:"新庄"},"odpt.Railway:JR-East.Yonesaka":{inbound:"米沢",outbound:"坂町"},"odpt.Railway:JR-Shikoku.SetoOhashi":{inbound:"岡山",outbound:"高松"},"odpt.Railway:JR-West.Sanin":{inbound:"京都",outbound:"幡生"},"odpt.Railway:Jomo.Jomo":{inbound:"高崎",outbound:"西桐生"},"odpt.Railway:Joshin.Joshin":{inbound:"高崎",outbound:"下仁田"},"odpt.Railway:KantoRailway.Ryugasaki":{inbound:"佐貫",outbound:"竜ヶ崎"},"odpt.Railway:KashimaRinkai.OaraiKashima":{inbound:"水戸",outbound:"鹿島神宮"},"odpt.Railway:Keisei.Chiba":{inbound:"京成津田沼",outbound:"千葉中央"},"odpt.Railway:Keisei.HigashiNarita":{inbound:"京成成田",outbound:"東成田"},"odpt.Railway:Keisei.Kanamachi":{inbound:"京成高砂",outbound:"金町"},"odpt.Railway:Keisei.Main":{inbound:"京成上野",outbound:"成田空港"},"odpt.Railway:Keisei.NaritaSkyAccess":{inbound:"京成上野",outbound:"成田空港"},"odpt.Railway:Keisei.Oshiage":{inbound:"押上",outbound:"京成高砂"},"odpt.Railway:Kominato.Kominato":{inbound:"五井",outbound:"上総中野"},"odpt.Railway:TokyoMetro.Hanzomon":{inbound:"渋谷",outbound:"押上"},"odpt.Railway:MIR.TsukubaExpress":{inbound:"秋葉原",outbound:"つくば"},"odpt.Railway:MaihamaResort.DisneyResort":{inbound:"リゾートゲートウェイ",outbound:"東京ディズニーランド"},"odpt.Railway:Minatomirai.Minatomirai":{inbound:"横浜",outbound:"元町・中華街"},"odpt.Railway:OdakyuHakone.HakoneTozan":{inbound:"小田原",outbound:"強羅"},"odpt.Railway:Ryutetsu.Nagareyama":{inbound:"馬橋",outbound:"流山"},"odpt.Railway:SaitamaRailway.SaitamaRailway":{inbound:"赤羽岩淵",outbound:"浦和美園"},"odpt.Railway:SaitamaTransit.NewShuttle":{inbound:"大宮",outbound:"内宿"},"odpt.Railway:SendaiAirportTransit.SendaiAirport":{inbound:"仙台",outbound:"仙台空港"},"odpt.Railway:SendaiMunicipal.Namboku":{inbound:"泉中央",outbound:"富沢"},"odpt.Railway:SendaiMunicipal.Tozai":{inbound:"八木山動物公園",outbound:"荒井"},"odpt.Railway:Shibayama.Shibayama":{inbound:"東成田",outbound:"芝山千代田"},"odpt.Railway:ShinKeisei.ShinKeisei":{inbound:"松戸",outbound:"京成津田沼"},"odpt.Railway:ShonanMonorail.ShonanMonorail":{inbound:"大船",outbound:"湘南江の島"},"odpt.Railway:TWR.Rinkai":{inbound:"大崎",outbound:"新木場"},"odpt.Railway:TamaMonorail.TamaMonorail":{inbound:"上北台",outbound:"多摩センター"},"odpt.Railway:Toei.Arakawa":{inbound:"早稲田",outbound:"三ノ輪橋"},"odpt.Railway:Toei.Asakusa":{inbound:"西馬込",outbound:"押上"},"odpt.Railway:Toei.Mita":{inbound:"目黒",outbound:"西高島平"},"odpt.Railway:Toei.NipporiToneri":{inbound:"日暮里",outbound:"見沼代親水公園"},"odpt.Railway:Toei.Oedo":{inbound:"光が丘",outbound:"大門"},"odpt.Railway:Toei.Shinjuku":{inbound:"新宿",outbound:"本八幡"},"odpt.Railway:TokyoMetro.Chiyoda":{inbound:"代々木上原",outbound:"取手"},"odpt.Railway:TokyoMetro.Fukutoshin":{inbound:"渋谷",outbound:"和光市"},"odpt.Railway:TokyoMetro.Ginza":{inbound:"渋谷",outbound:"浅草"},"odpt.Railway:TokyoMetro.Hibiya":{inbound:"中目黒",outbound:"北千住"},"odpt.Railway:TokyoMetro.Marunouchi":{inbound:"荻窪",outbound:"池袋"},"odpt.Railway:TokyoMetro.Namboku":{inbound:"目黒",outbound:"赤羽岩淵"},"odpt.Railway:TokyoMetro.Tozai":{inbound:"中野",outbound:"西船橋"},"odpt.Railway:TokyoMetro.Yurakucho":{inbound:"新木場",outbound:"和光市"},"odpt.Railway:TokyoMonorail.HanedaAirport":{inbound:"浜松町",outbound:"羽田空港"},"odpt.Railway:UtsunomiyaLightRail.UtsunomiyaLightRail":{inbound:"宇都宮駅東口",outbound:"芳賀・高根沢工業団地"},"odpt.Railway:WataraseKeikoku.WataraseKeikoku":{inbound:"桐生",outbound:"間藤"},"odpt.Railway:Yagan.AizuKinugawa":{inbound:"新藤原",outbound:"会津高原"},"odpt.Railway:YokohamaMunicipal.Blue":{inbound:"湘南台",outbound:"あざみ野"},"odpt.Railway:YokohamaMunicipal.Green":{inbound:"中山",outbound:"日吉"},"odpt.Railway:YokohamaSeaside.KanazawaSeaside":{inbound:"新杉田",outbound:"金沢八景"},"odpt.Railway:Yurikamome.Yurikamome":{inbound:"新橋",outbound:"豊洲"},"odpt.Railway:Keio.Inokashira":{inbound:"渋谷",outbound:"吉祥寺"},"odpt.Railway:Keio.KeioNew":{inbound:"新宿",outbound:"笹塚"},"odpt.Railway:Keio.Keio":{inbound:"新宿",outbound:"京王八王子"},"odpt.Railway:Keio.Sagamihara":{inbound:"調布",outbound:"橋本"},"odpt.Railway:KantoRailway.Joso":{inbound:"取手",outbound:"下館"},"odpt.Railway:Keio.Takao":{inbound:"北野",outbound:"高尾山口"},"odpt.Railway:ToyoRapid.ToyoRapid":{inbound:"西船橋",outbound:"東葉勝田台"},"odpt.Railway:JR-East.Agatsuma":{inbound:"渋川",outbound:"大前"},"odpt.Railway:JR-East.ChuoRapid":{inbound:"東京",outbound:"高尾"},"odpt.Railway:JR-East.Hachiko":{inbound:"八王子",outbound:"高崎"},"odpt.Railway:JR-East.Ito":{inbound:"熱海",outbound:"伊東"},"odpt.Railway:JR-East.Kawagoe":{inbound:"大宮",outbound:"高麗川"},"odpt.Railway:JR-East.Itsukaichi":{inbound:"拝島",outbound:"武蔵五日市"},"odpt.Railway:JR-East.JobanLocal":{inbound:"代々木上原",outbound:"取手"},"odpt.Railway:JR-East.JobanRapid":{inbound:"上野",outbound:"取手"},"odpt.Railway:JR-East.Joetsu":{inbound:"高崎",outbound:"長岡"},"odpt.Railway:JR-East.Kashima":{inbound:"香取",outbound:"鹿島神宮"},"odpt.Railway:JR-East.KeihinTohokuNegishi":{inbound:"大宮",outbound:"大船"},"odpt.Railway:JR-East.Keiyo":{inbound:"東京",outbound:"蘇我"},"odpt.Railway:JR-East.Kururi":{inbound:"木更津",outbound:"上総亀山"},"odpt.Railway:JR-East.Narita":{inbound:"佐倉",outbound:"銚子"},"odpt.Railway:JR-East.Musashino":{inbound:"府中本町",outbound:"西船橋"},"odpt.Railway:JR-East.NambuBranch":{inbound:"尻手",outbound:"浜川崎"},"odpt.Railway:JR-East.Nambu":{inbound:"川崎",outbound:"立川"},"odpt.Railway:JR-East.NaritaAbikoBranch":{inbound:"我孫子",outbound:"成田"},"odpt.Railway:JR-East.NaritaAirportBranch":{inbound:"成田",outbound:"成田空港"},"odpt.Railway:JR-East.Ome":{inbound:"立川",outbound:"奥多摩"},"odpt.Railway:JR-East.Sagami":{inbound:"茅ヶ崎",outbound:"橋本"},"odpt.Railway:JR-East.SaikyoKawagoe":{inbound:"大崎",outbound:"川越"},"odpt.Railway:JR-East.ShonanShinjuku":{inbound:"大宮",outbound:"大船"},"odpt.Railway:JR-East.SobuRapid":{inbound:"東京",outbound:"千葉"},"odpt.Railway:JR-East.Sobu":{inbound:"千葉",outbound:"銚子"},"odpt.Railway:JR-East.SotetsuDirect":{inbound:"新宿",outbound:"海老名"},"odpt.Railway:JR-East.Sotobo":{inbound:"千葉",outbound:"安房鴨川"},"odpt.Railway:JR-East.Takasaki":{inbound:"上野",outbound:"高崎"},"odpt.Railway:JR-East.Togane":{inbound:"成東",outbound:"大網"},"odpt.Railway:JR-East.Tokaido":{inbound:"東京",outbound:"熱海"},"odpt.Railway:JR-East.TsurumiOkawaBranch":{inbound:"浅野",outbound:"大川"},"odpt.Railway:JR-East.TsurumiUmiShibauraBranch":{inbound:"浅野",outbound:"海芝浦"},"odpt.Railway:JR-East.Tsurumi":{inbound:"鶴見",outbound:"扇町"},"odpt.Railway:JR-East.Uchibo":{inbound:"蘇我",outbound:"安房鴨川"},"odpt.Railway:JR-East.Utsunomiya":{inbound:"上野",outbound:"黒磯"},"odpt.Railway:JR-East.Yamanote":{inbound:"内回り",outbound:"外回り"},"odpt.Railway:JR-East.Yokohama":{inbound:"東神奈川",outbound:"八王子"},"odpt.Railway:JR-East.Yokosuka":{inbound:"東京",outbound:"久里浜"}};let gt=[],K=null,H=null,B=null,it="渋谷・副都心線方面",nt="横浜・元町中華街方面";const L=zt,D={},Y=new Map;let Jt=[];const I=new Pt(500);function Ft(){return H||"odpt.RailDirection:Inbound"}function Wt(){return B||"odpt.RailDirection:Outbound"}function Gt(){try{const t=K?K["owl:sameAs"]||K["@id"]:null;if(t&&L[t]&&L[t].inbound)return L[t].inbound}catch{}return it}function qt(){try{const t=K?K["owl:sameAs"]||K["@id"]:null;if(t&&L[t]&&L[t].outbound)return L[t].outbound}catch{}return nt}function rt(){return gt}function Vt(t){gt=t}function x(){return Jt}async function Zt(t,o){try{const a=await Bt(t,o);for(const i of a){const n=i["owl:sameAs"]||i["@id"],e=C(i["dc:title"]);n&&typeof n=="string"&&Y.set(n,e)}}catch(a){console.warn("Failed to load direction names:",a)}}async function Xt(t,o){try{const a=await Yt(t,o);for(const i of a){const n=i["owl:sameAs"]||i["@id"];if(!n||typeof n!="string")continue;const e=C(i["dc:title"]);if(!e)continue;const u=$t(n);D[n]={name:e,class:u}}console.log(`Loaded ${Object.keys(D).length} train types`)}catch(a){console.warn("Failed to load train types:",a)}}async function G(t,o,a){try{const i=await Ht(t,o,a);if(!i){console.warn("Railway not found:",t);return}K=i,H=i["odpt:descendingRailDirection"]||"odpt.RailDirection:Inbound",B=i["odpt:ascendingRailDirection"]||"odpt.RailDirection:Outbound",H&&Y.has(H)&&(it=Y.get(H)||it),B&&Y.has(B)&&(nt=Y.get(B)||nt),Jt=(i["odpt:stationOrder"]||[]).map(u=>{const d=u["odpt:station"]||"",s=u["odpt:stationTitle"],y=C(s),m=u["odpt:index"]||-1;return{name:y,uri:d,index:m}}).filter(u=>u.uri&&u.name!=="N/A").sort((u,d)=>u.index-d.index);const e=C(i["dc:title"]||i["odpt:railwayTitle"]);Qo(`${e} 発車案内板`)}catch(i){console.warn("Failed to load railway metadata:",i)}}async function Qt(t,o,...a){const i=Dt(...a),n=Array.from(i).filter(e=>!I.has(e));if(n.length!==0)try{const e=await vt(n,t,o);for(const u of e){const d=u["owl:sameAs"]||u["@id"]||u.id,s=C(u["dc:title"]||u["odpt:stationTitle"]||u.title);d&&typeof d=="string"&&I.set(d,s)}for(const u of n)I.has(u)||I.set(u,u)}catch(e){console.warn("Failed to fetch station names for destinations:",e)}}const q={東京都:["odpt.Railway:Odakyu.Odawara","odpt.Railway:Keikyu.Main","odpt.Railway:Tobu.TobuSkytree","odpt.Railway:JR-East.ChuoSobuLocal","odpt.Railway:Keikyu.Airport","odpt.Railway:Tokyu.DenEnToshi","odpt.Railway:Tokyu.Ikegami","odpt.Railway:Tobu.Daishi","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.Joban","odpt.Railway:Seibu.Toshima","odpt.Railway:Odakyu.Tama","odpt.Railway:Tokyu.Setagaya","odpt.Railway:Seibu.Haijima","odpt.Railway:Seibu.Ikebukuro","odpt.Railway:Seibu.Kokubunji","odpt.Railway:Seibu.SeibuYurakucho","odpt.Railway:Seibu.Seibuen","odpt.Railway:Seibu.Shinjuku","odpt.Railway:Seibu.Tamagawa","odpt.Railway:Seibu.Tamako","odpt.Railway:Seibu.Yamaguchi","odpt.Railway:Tokyu.Kodomonokuni","odpt.Railway:Tokyu.Meguro","odpt.Railway:Tokyu.Oimachi","odpt.Railway:Tokyu.TokyuShinYokohama","odpt.Railway:Tokyu.TokyuTamagawa","odpt.Railway:Tokyu.Toyoko","odpt.Railway:Tobu.Kameido","odpt.Railway:Tobu.TobuSkytreeBranch","odpt.Railway:Hokuso.Hokuso","odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.JoetsuShinkansen","odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.Ou","odpt.Railway:Keisei.Main","odpt.Railway:Keisei.NaritaSkyAccess","odpt.Railway:Keisei.Oshiage","odpt.Railway:TokyoMetro.Hanzomon","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:TokyoMonorail.HanedaAirport","odpt.Railway:TWR.Rinkai","odpt.Railway:TamaMonorail.TamaMonorail","odpt.Railway:Toei.Arakawa","odpt.Railway:Toei.Asakusa","odpt.Railway:Toei.Mita","odpt.Railway:Toei.NipporiToneri","odpt.Railway:Toei.Oedo","odpt.Railway:Toei.Shinjuku","odpt.Railway:TokyoMetro.Chiyoda","odpt.Railway:TokyoMetro.Fukutoshin","odpt.Railway:TokyoMetro.Ginza","odpt.Railway:TokyoMetro.Hibiya","odpt.Railway:TokyoMetro.Marunouchi","odpt.Railway:TokyoMetro.Namboku","odpt.Railway:TokyoMetro.Tozai","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:Yurikamome.Yurikamome","odpt.Railway:Keio.Inokashira","odpt.Railway:Keio.KeioNew","odpt.Railway:Keio.Keio","odpt.Railway:Keio.Sagamihara","odpt.Railway:Keio.Takao","odpt.Railway:JR-East.ChuoRapid","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.Kawagoe","odpt.Railway:JR-East.Itsukaichi","odpt.Railway:JR-East.JobanLocal","odpt.Railway:JR-East.JobanRapid","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.Keiyo","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.Nambu","odpt.Railway:JR-East.Ome","odpt.Railway:JR-East.SaikyoKawagoe","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.SobuRapid","odpt.Railway:JR-East.SotetsuDirect","odpt.Railway:JR-East.Tokaido","odpt.Railway:JR-East.Utsunomiya","odpt.Railway:JR-East.Yamanote","odpt.Railway:JR-East.Yokohama","odpt.Railway:JR-East.Yokosuka"],神奈川県:["odpt.Railway:Odakyu.Odawara","odpt.Railway:Keikyu.Main","odpt.Railway:Keikyu.Airport","odpt.Railway:Keikyu.Daishi","odpt.Railway:Tokyu.DenEnToshi","odpt.Railway:Tokyu.Ikegami","odpt.Railway:Sotetsu.Izumino","odpt.Railway:Sotetsu.Main","odpt.Railway:Sotetsu.SotetsuShinYokohama","odpt.Railway:JR-Central.TokaidoShinkansen","odpt.Railway:Odakyu.Enoshima","odpt.Railway:Odakyu.Tama","odpt.Railway:Keikyu.Kurihama","odpt.Railway:Keikyu.Zushi","odpt.Railway:Tokyu.Kodomonokuni","odpt.Railway:Tokyu.Meguro","odpt.Railway:Tokyu.Oimachi","odpt.Railway:Tokyu.TokyuShinYokohama","odpt.Railway:Tokyu.TokyuTamagawa","odpt.Railway:Choshi.Choshi","odpt.Railway:Tokyu.Toyoko","odpt.Railway:Enoden.Enoden","odpt.Railway:JR-Central.Tokaido","odpt.Railway:Minatomirai.Minatomirai","odpt.Railway:OdakyuHakone.HakoneTozan","odpt.Railway:ShonanMonorail.ShonanMonorail","odpt.Railway:JR-East.Tokaido","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.NambuBranch","odpt.Railway:JR-East.Nambu","odpt.Railway:JR-East.Sagami","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.SotetsuDirect","odpt.Railway:JR-East.TsurumiOkawaBranch","odpt.Railway:JR-East.TsurumiUmiShibauraBranch","odpt.Railway:JR-East.Tsurumi","odpt.Railway:JR-East.Yokohama","odpt.Railway:JR-East.Yokosuka","odpt.Railway:YokohamaMunicipal.Blue","odpt.Railway:YokohamaMunicipal.Green","odpt.Railway:YokohamaSeaside.KanazawaSeaside"],千葉県:["odpt.Railway:JR-East.ChuoSobuLocal","odpt.Railway:ChibaMonorail.Line2","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:Isumi.Isumi","odpt.Railway:Choshi.Choshi","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:ChibaMonorail.Line1","odpt.Railway:Hokuso.Hokuso","odpt.Railway:Keisei.Chiba","odpt.Railway:Keisei.HigashiNarita","odpt.Railway:Keisei.Kanamachi","odpt.Railway:Keisei.Main","odpt.Railway:Keisei.NaritaSkyAccess","odpt.Railway:Keisei.Oshiage","odpt.Railway:Kominato.Kominato","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:MaihamaResort.DisneyResort","odpt.Railway:Ryutetsu.Nagareyama","odpt.Railway:Shibayama.Shibayama","odpt.Railway:ShinKeisei.ShinKeisei","odpt.Railway:TWR.Rinkai","odpt.Railway:Toei.Shinjuku","odpt.Railway:TokyoMetro.Tozai","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:ToyoRapid.ToyoRapid","odpt.Railway:JR-East.Keiyo","odpt.Railway:JR-East.Kashima","odpt.Railway:JR-East.Kururi","odpt.Railway:JR-East.Narita","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.NaritaAbikoBranch","odpt.Railway:JR-East.NaritaAirportBranch","odpt.Railway:JR-East.SobuRapid","odpt.Railway:JR-East.Sobu","odpt.Railway:JR-East.Sotobo","odpt.Railway:JR-East.Togane","odpt.Railway:JR-East.Uchibo"],埼玉県:["odpt.Railway:Tobu.TobuSkytree","odpt.Railway:Tobu.Daishi","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:Tobu.Tojo","odpt.Railway:Tobu.Ogose","odpt.Railway:Chichibu.Chichibu","odpt.Railway:Seibu.Haijima","odpt.Railway:Seibu.Ikebukuro","odpt.Railway:Seibu.Sayama","odpt.Railway:Seibu.SeibuChichibu","odpt.Railway:Seibu.SeibuYurakucho","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:SaitamaRailway.SaitamaRailway","odpt.Railway:SaitamaTransit.NewShuttle","odpt.Railway:TokyoMetro.Fukutoshin","odpt.Railway:TokyoMetro.Namboku","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:JR-East.Kawagoe","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.SaikyoKawagoe","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.Takasaki","odpt.Railway:JR-East.Utsunomiya"],群馬県:["odpt.Railway:Tobu.Kiryu","odpt.Railway:Tobu.Isesaki","odpt.Railway:Tobu.KoizumiBranch","odpt.Railway:Tobu.Koizumi","odpt.Railway:Jomo.Jomo","odpt.Railway:Joshin.Joshin","odpt.Railway:WataraseKeikoku.WataraseKeikoku","odpt.Railway:JR-East.Agatsuma","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.Joetsu","odpt.Railway:JR-East.Ryomo","odpt.Railway:JR-East.Takasaki"],栃木県:["odpt.Railway:Tobu.Nikko","odpt.Railway:Tobu.Kinugawa","odpt.Railway:Tobu.Sano","odpt.Railway:Tobu.Utsunomiya","odpt.Railway:Yagan.AizuKinugawa","odpt.Railway:JR-East.Nikko","odpt.Railway:JR-East.Ryomo","odpt.Railway:JR-East.Utsunomiya","odpt.Railway:JR-East.Karasuyama","odpt.Railway:JR-East.Mito","odpt.Railway:JR-East.Tohoku","odpt.Railway:UtsunomiyaLightRail.UtsunomiyaLightRail"],茨城県:["odpt.Railway:JR-East.Joban","odpt.Railway:JR-East.Mito","odpt.Railway:JR-East.SuigunBranch","odpt.Railway:JR-East.Suigun","odpt.Railway:Hitachinaka.Minato","odpt.Railway:KantoRailway.Ryugasaki","odpt.Railway:KantoRailway.Joso","odpt.Railway:KashimaRinkai.OaraiKashima","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:TokyoMetro.Chiyoda","odpt.Railway:JR-East.JobanLocal","odpt.Railway:JR-East.JobanRapid","odpt.Railway:JR-East.Kashima"],山梨県:["odpt.Railway:Fujikyu.Fujikyu","odpt.Railway:JR-Central.Minobu","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.ChuoRapid","odpt.Railway:JR-East.Koumi","odpt.Railway:JR-East.Oito"],静岡県:["odpt.Railway:JR-Central.TokaidoShinkansen","odpt.Railway:JR-Central.Gotemba","odpt.Railway:JR-Central.Minobu","odpt.Railway:JR-Central.Tokaido","odpt.Railway:IzuHakone.Sunzu","odpt.Railway:IzuHakone.Daiyuzan","odpt.Railway:Izukyu.Izukyu","odpt.Railway:JR-East.Ito"],宮城県:["odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.Tohoku","odpt.Railway:JR-East.SensekiTohoku","odpt.Railway:JR-East.Senseki","odpt.Railway:JR-East.Senzan","odpt.Railway:JR-East.Ishinomaki","odpt.Railway:SendaiAirportTransit.SendaiAirport","odpt.Railway:SendaiMunicipal.Namboku","odpt.Railway:SendaiMunicipal.Tozai"],福島県:["odpt.Railway:Aizu.Aizu","odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.YamagataShinkansen","odpt.Railway:JR-East.Tohoku","odpt.Railway:JR-East.OuYamagata","odpt.Railway:JR-East.Ou","odpt.Railway:JR-East.BanetsuEast","odpt.Railway:JR-East.BanetsuWest","odpt.Railway:JR-East.Tadami","odpt.Railway:JR-East.SuigunBranch"],新潟県:["odpt.Railway:JR-East.JoetsuShinkansen","odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.Joetsu","odpt.Railway:JR-East.Shinetsu","odpt.Railway:JR-East.Uetsu","odpt.Railway:JR-East.Echigo","odpt.Railway:JR-East.Hakushin","odpt.Railway:JR-East.Iiyama","odpt.Railway:JR-East.Yahiko","odpt.Railway:JR-East.Yonesaka","odpt.Railway:Hokuetsu.Hokuhoku"],長野県:["odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.ChuoTatsunoBranch","odpt.Railway:JR-East.Koumi","odpt.Railway:JR-East.Iiyama","odpt.Railway:JR-East.Oito","odpt.Railway:JR-East.Shinetsu","odpt.Railway:JR-East.Shinonoi"]},to=["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"],oo="東京メトロ",ao="都営",io="東急",no="小田急",eo="京王",uo="西武",lo="東武",so="京成",ro="京急",yo="相鉄",po="横浜市営",co="千葉都市モノレール",Ro="富士急行",bo="秩父鉄道",wo="いすみ鉄道",mo="銚子電気鉄道",To="伊豆箱根鉄道",ko="伊豆急行",fo="江ノ島電鉄",ho="会津鉄道",Eo="ひたちなか海浜鉄道",So="北越急行",go="北総鉄道",Jo="上毛電気鉄道",Io="上信電鉄",xo="関東鉄道",Ko="鹿島臨海鉄道",Mo="小湊鉄道",Ao="首都圏新都市鉄道 (つくばエクスプレス)",Lo="舞浜リゾートライン",Oo="横浜高速鉄道",No="小田急箱根",Co="流鉄",Uo="埼玉高速鉄道",vo="埼玉新都市交通",_o="仙台空港鉄道",Ho="仙台市営",Bo="芝山鉄道",Yo="新京成電鉄",Do="湘南モノレール",Po="東京臨海高速鉄道",jo="多摩都市モノレール",$o="東葉高速鉄道",zo="宇都宮ライトレール",Fo="わたらせ渓谷鐵道",Wo="野岩鉄道",Go="横浜シーサイドライン",qo="ゆりかもめ",Vo={"JR-East":"JR東日本","JR-Central":"JR東海","JR-Shikoku":"JR四国","JR-West":"JR西日本",TokyoMetro:oo,Toei:ao,Tokyu:io,Odakyu:no,Keio:eo,Seibu:uo,Tobu:lo,Keisei:so,Keikyu:ro,Sotetsu:yo,YokohamaMunicipal:po,ChibaMonorail:co,Fujikyu:Ro,Chichibu:bo,Isumi:wo,Choshi:mo,IzuHakone:To,Izukyu:ko,Enoden:fo,Aizu:ho,Hitachinaka:Eo,Hokuetsu:So,Hokuso:go,Jomo:Jo,Joshin:Io,KantoRailway:xo,KashimaRinkai:Ko,Kominato:Mo,MIR:Ao,MaihamaResort:Lo,Minatomirai:Oo,OdakyuHakone:No,Ryutetsu:Co,SaitamaRailway:Uo,SaitamaTransit:vo,SendaiAirportTransit:_o,SendaiMunicipal:Ho,Shibayama:Bo,ShinKeisei:Yo,ShonanMonorail:Do,TWR:Po,TamaMonorail:jo,ToyoRapid:$o,UtsunomiyaLightRail:zo,WataraseKeikoku:Fo,Yagan:Wo,YokohamaSeaside:Go,Yurikamome:qo},A=5,O="t2board_railway_uri",N="t2board_station_uri",et="t2board_api_key",It="t2board_recent_railways",v="t2board_prefecture",Zo=5,Xo=15e3;let yt=!1,pt=!1;function Qo(t){document.title=t}function ta(t){const o=document.getElementById("station-header");o&&(o.textContent=t||"")}function oa(){const t=document.getElementById("departures-inbound"),o=document.getElementById("departures-outbound"),a='<p class="text-center text-2xl pt-8">時刻表を取得中...</p>';t&&(t.innerHTML=a),o&&(o.innerHTML=a)}function aa(t,o){const a=document.getElementById("direction-inbound-header"),i=document.getElementById("direction-outbound-header");a&&(a.textContent=t),i&&(i.textContent=o)}function xt(t,o){let a="N/A";const i=t["odpt:destinationStation"];if(Array.isArray(i)&&i.length>0){const n=i[0];if(typeof n=="string")a=o.get(n)||n;else if(n&&typeof n=="object"&&(a=n["dc:title"]||n.title||"N/A",(!a||a==="N/A")&&n["owl:sameAs"])){const e=n["owl:sameAs"];typeof e=="string"&&(a=o.get(e)||e)}}else typeof i=="string"&&(a=o.get(i)||i);return a}function ct(t,o,a,i){const n=document.getElementById(`departures-${t}`);if(n){if(o.length===0){n.innerHTML='<p class="text-center text-2xl pt-8">本日の発車予定はありません。</p>';return}n.innerHTML=o.map(e=>{const u=e["odpt:departureTime"]||"",d=e["odpt:trainType"]||"",s=xt(e,a),y=i[d]||{name:"不明",class:"type-LOC"};return`
        <div class="train-row items-center justify-between" data-departure="${u}">
          <div class="minutes-col text-center" data-departure="${u}">--</div>
          <div class="time-col text-center">${u||"--"}</div>
          <div class="flex justify-center items-center">
            <span class="train-type-badge ${y.class}">${y.name}</span>
          </div>
          <div class="destination-text">${s}</div>
        </div>`}).join("")}}let V,Kt=[],Mt=[],ut=A-1,dt=A-1;function ia(t){const[o,a]=(t||"").split(":"),i=Number(o||0),n=Number(a||0);return i*3600+n*60}function Rt(t,o,a,i){const n=new Date,e=n.getHours()*3600+n.getMinutes()*60+n.getSeconds(),u=(d,s)=>{const y=document.getElementById(`departures-${d}`);if(!y||!s||!a||!i){console.warn(`updateMinutesOnce: Missing required parameters for ${d}`,{container:!!y,trainCache:!!s,stationNameCache:!!a,trainTypeMap:!!i});return}const m=Array.from(y.querySelectorAll(".train-row[data-departure]")),E=d==="inbound"?Kt:Mt,P=d==="inbound"?ut:dt,S=[];for(const T of m){const w=T.getAttribute("data-departure")||"",r=ia(w)-e,l=T.querySelector(".minutes-col");if(l)if(r<=0)S.push(T);else if(r<=60)l.textContent="到着";else{const c=Math.ceil(r/60);l.textContent=`${c}分`}}if(S.length>0){const T=P+1,w=s.slice(T,T+S.length);w.length>0&&(d==="inbound"?ut=T+w.length-1:dt=T+w.length-1),S.forEach(R=>{const r=R.getAttribute("data-departure")||"",l=E.indexOf(r);l>-1&&E.splice(l,1),R.remove()}),w.forEach(R=>{const r=R["odpt:departureTime"];if(!r||E.includes(r))return;const l=R["odpt:trainType"]||"",c=xt(R,a),k=i[l]||{name:"不明",class:"type-LOC"},f=`
          <div class="train-row items-center justify-between" data-departure="${r}">
            <div class="minutes-col text-center" data-departure="${r}">--</div>
            <div class="time-col text-center">${r}</div>
            <div class="flex justify-center items-center">
              <span class="train-type-badge ${k.class}">${k.name}</span>
            </div>
            <div class="destination-text">${c}</div>
          </div>`;y.insertAdjacentHTML("beforeend",f),E.push(r)})}};u("inbound",t),u("outbound",o)}function na(t,o,a,i,n=Xo){t&&(Kt=t.slice(0,A).map(e=>e["odpt:departureTime"]).filter(Boolean),ut=A-1),o&&(Mt=o.slice(0,A).map(e=>e["odpt:departureTime"]).filter(Boolean),dt=A-1),Rt(t,o,a,i),typeof V<"u"&&clearInterval(V),V=window.setInterval(()=>Rt(t,o,a,i),n)}function bt(){const t=document.getElementById("time-header");t&&(t.textContent=ft())}function wt(t,o){const a=localStorage.getItem(N),i=t.find(e=>e.name===o)||t[0];let n=i;if(a){const e=t.find(u=>u.uri===a);e&&(n=e)}else t.length>0&&(n=i||t[0]);return n}function At(){try{const t=localStorage.getItem(It);return t?JSON.parse(t):[]}catch{return[]}}function ea(t){try{let o=At();o=o.filter(a=>a!==t),o.unshift(t),o=o.slice(0,Zo),localStorage.setItem(It,JSON.stringify(o))}catch(o){console.warn("Failed to save recent railway:",o)}}function ua(t,o){const a=localStorage.getItem(O),i=t.find(e=>e.uri===o)||t[0];let n=i;if(a){const e=t.find(u=>u.uri===a);e&&(n=e)}else t.length>0&&(n=i||t[0]);return n}function da(t){if(!t)return"その他";const o=t.split(":"),a=o.length>1?o[1]:t;return Vo[a]||a}function la(t,o,a,i,n,e,u){const d=document.getElementById("config-modal"),s=document.getElementById("railway-select"),y=document.getElementById("station-select"),m=document.getElementById("prefecture-select");if(!d||!s||!y||!m)return;function E(w,R){if(!s)return;let r="";const l=At();let c=null;R&&q[R]&&(c=new Set(q[R]));const k=l.map(p=>t.find(h=>h.uri===p)).filter(p=>p!==void 0).filter(p=>c?c.has(p.uri):!0);if(k.length>0){r+='<optgroup label="最近使用した路線">';for(const p of k)r+=`<option value="${p.uri}" ${p.uri===w?"selected":""}>${p.name}</option>`;r+="</optgroup>"}const f=new Map;for(const p of t){if(c&&!c.has(p.uri))continue;const h=da(p.operator);f.has(h)||f.set(h,[]),f.get(h).push(p)}const F=Array.from(f.keys()).sort((p,h)=>p.localeCompare(h,"ja"));for(const p of F){const h=f.get(p);r+=`<optgroup label="${p}">`;for(const W of h)r+=`<option value="${W.uri}" ${W.uri===w?"selected":""}>${W.name}</option>`;r+="</optgroup>"}s.innerHTML=r}function P(w){if(!m)return;const R=new Set(Object.keys(q)),r=to.filter(l=>R.has(l));m.innerHTML=r.map(l=>`<option value="${l}" ${l===w?"selected":""}>${l}</option>`).join("")}function S(w){if(!y)return;const R=x();y.innerHTML=R.map(r=>`<option value="${r.uri}" ${r.uri===w?"selected":""}>${r.name}</option>`).join("")}const T=localStorage.getItem(v)||"東京都";P(T),E(a,T),S(i),pt||(document.getElementById("settings-button")?.addEventListener("click",()=>{const l=localStorage.getItem(O),c=localStorage.getItem(N),k=localStorage.getItem(v)||"東京都";P(k),E(l,k),S(c),sa()}),document.getElementById("close-modal")?.addEventListener("click",()=>{Z()}),s?.addEventListener("change",async()=>{if(!s)return;const l=s.value;if(y&&(y.innerHTML="<option>駅を読込中...</option>",y.disabled=!0),u)try{await u(l),S(null)}catch(c){console.error("Failed to load stations:",c),y&&(y.innerHTML="<option>駅の読込に失敗しました</option>")}finally{y&&(y.disabled=!1)}}),m?.addEventListener("change",async()=>{if(!m)return;const l=m.value;try{localStorage.setItem(v,l)}catch{}E(null,l)}),document.getElementById("save-settings")?.addEventListener("click",()=>{if(!s||!y||!m)return;const l=s.value,c=y.value,k=m.value,f=localStorage.getItem(O),F=localStorage.getItem(N),p=localStorage.getItem(v);localStorage.setItem(v,k),localStorage.setItem(O,l),localStorage.setItem(N,c),ea(l),k!==p||l!==f?n(l):c!==F&&e(c),Z()}),d.addEventListener("click",l=>{l.target===d&&Z()}),pt=!0)}function mt(t,o){const a=document.getElementById("api-key-modal"),i=document.getElementById("api-key-input");if(!(!a||!i)&&(i.value=t||"",!yt)){const n=document.getElementById("save-api-key"),e=document.getElementById("close-api-key");n?.addEventListener("click",()=>{const u=i.value?i.value.trim():null;u?localStorage.setItem(et,u):localStorage.removeItem(et),o(u),X()}),e?.addEventListener("click",()=>X()),a.addEventListener("click",u=>{u.target===a&&X()}),yt=!0}}function sa(){const t=document.getElementById("config-modal");t&&(t.classList.remove("hidden"),t.classList.add("flex","opacity-100"))}function Z(){const t=document.getElementById("config-modal");t&&(t.classList.remove("flex","opacity-100"),t.classList.add("hidden"))}function Lt(){const t=document.getElementById("api-key-modal");t&&(t.classList.remove("hidden"),t.classList.add("flex","opacity-100"))}function X(){const t=document.getElementById("api-key-modal");t&&(t.classList.remove("flex","opacity-100"),t.classList.add("hidden"))}function Ot(t,o="info"){const a=document.getElementById("status-banner");a&&(a.classList.remove("hidden"),a.classList.remove("bg-red-100","bg-yellow-100","bg-blue-100","text-red-800"),o==="error"?a.classList.add("bg-red-100","text-red-800"):o==="warn"?a.classList.add("bg-yellow-100"):a.classList.add("bg-blue-100"),a.textContent=t)}function ra(){const t=document.getElementById("status-banner");t&&(t.classList.add("hidden"),t.textContent="")}let z=null,Nt="https://api-challenge.odpt.org/api/v4/",Ct="odpt.Railway:Tokyu.Toyoko",lt="武蔵小杉 (TY11)";const ya=3e5,pa=3e5,ca=1e4;function Tt(t){z=t}function g(){return z}function U(){return Nt}async function Ra(){try{const t=await fetch("./config.json",{cache:"no-store"});if(!t.ok)return;const o=await t.json();o?.ODPT_API_KEY&&(z=o.ODPT_API_KEY),o?.DEFAULT_RAILWAY&&(Ct=o.DEFAULT_RAILWAY),o?.DEFAULT_STATION_NAME&&(lt=o.DEFAULT_STATION_NAME),o?.API_BASE_URL&&(Nt=o.API_BASE_URL)}catch(t){const o=t instanceof Error?t:new Error(String(t));console.warn("Failed to load ./config.json:",o.message)}}async function ba(){await Ra();try{const t=localStorage.getItem(et);t&&(z=t)}catch{}}let b={railwayUri:null,stationUri:null,stationName:null},Q,tt;function J(){return b}function _(t){b=t}function wa(){if(!g()){const i=document.getElementById("departures-inbound"),n=document.getElementById("departures-outbound"),e='<p class="text-center text-red-500 text-2xl pt-8">エラー: config.json に ODPT_API_KEY を設定してください。</p>';return i&&(i.innerHTML=e),n&&(n.innerHTML=e),null}const a=x().find(i=>i.uri===b.stationUri);if(!a||!b.railwayUri){const i=ht("station-header");return i&&(i.textContent="エラー: 駅または路線が選択されていません"),null}return a}async function j(t){const o=g();if(!o)return!1;let a=[];try{a=await Ut(t,o,U(),b.railwayUri)}catch(d){return console.error("Failed to fetch timetable:",d),Ot("API エラーが発生しました。API キーを確認してください。","error"),Lt(),!1}const n=kt(ft(new Date)),e=st(a,Ft(),n),u=st(a,Wt(),n);return await Qt(o,U(),e,u),ct("inbound",e,I,D),ct("outbound",u,I,D),na(e,u,I,D),!0}async function ma(){const t=g();if(t)try{b.railwayUri&&(await at(t,U(),b.railwayUri),ra())}catch(o){console.warn("Failed to fetch status:",o),Ot("運行情報取得でエラーが発生しました。API キーを確認してください。","warn")}}function Ta(t){typeof Q<"u"&&clearInterval(Q),typeof tt<"u"&&clearInterval(tt),Q=window.setInterval(async()=>{try{const o=localStorage.getItem(N);o?await j(o):await j(b.stationUri)}catch{b.stationUri&&await j(b.stationUri)}},ya),tt=window.setInterval(async()=>{const o=g();if(o)try{const i=localStorage.getItem(O)||b.railwayUri;i&&await at(o,U(),i)}catch{b.railwayUri&&await at(o,U(),b.railwayUri)}},pa),window.setInterval(bt,ca),bt()}async function ot(){try{const a=localStorage.getItem(O),i=localStorage.getItem(N);if(a&&(b.railwayUri=a),i){b.stationUri=i;const e=x().find(u=>u.uri===i);e&&(b.stationName=e.name)}}catch(a){console.warn("Failed to load config from localStorage:",a)}const t=wa();!t||(ta(t.name),oa(),aa(Gt(),qt()),!await j(t.uri))||(await ma(),Ta(t.uri))}async function $(){try{await ba()}catch(e){const u=e instanceof Error?e:new Error(String(e));console.warn("Error loading local config:",u.message)}if(jt(),!g()){mt(g(),e=>{e&&Tt(e),$()}),Lt();return}const t=String(g()),o=U();await Zt(t,o),await Xt(t,o);try{const u=(await _t(t,o)).filter(d=>d["@type"]==="odpt:Railway").map(d=>{const s=C(d["dc:title"]||d["odpt:railwayTitle"]),y=d["odpt:operator"]||"";return{uri:d["owl:sameAs"]||d["@id"]||"",name:s,operator:y}}).filter(d=>d.uri&&d.name).sort((d,s)=>d.name.localeCompare(s.name,"ja"));Vt(u)}catch(e){const u=e instanceof Error?e:new Error(String(e));console.error("Error fetching railway list:",u.message);const d=ht("station-header");d&&(d.textContent="エラー: 路線リスト取得失敗")}const a=ua(rt(),Ct);let i=J();a&&(i.railwayUri=a.uri,_(i),await G(a.uri,t,o));const n=wt(x(),lt);n&&(i=J(),i.stationUri=n.uri,i.stationName=n.name,_(i)),mt(g(),e=>{e&&Tt(e),$()}),la(rt(),x(),J().railwayUri,J().stationUri,async e=>{let u=J();u.railwayUri=e,_(u),await G(e,t,o);const d=wt(x(),lt);d&&(u=J(),u.stationUri=d.uri,u.stationName=d.name,_(u)),ot()},e=>{const u=x().find(s=>s.uri===e),d=J();d.stationUri=e,d.stationName=u?u.name:null,_(d),ot()},async e=>{await G(e,t,o)}),ot()}window.initializeBoard=$;window.onload=$;
