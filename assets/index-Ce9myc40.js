(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();async function x(t,o=3,i=1e3){for(let a=0;a<o;a++)try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}`);return e}catch(e){if(a===o-1)throw e;await new Promise(n=>setTimeout(n,i*2**a))}throw new Error("Unreachable")}async function Mt(t,o,i,a){if(!o||!i||!t||!a)throw new Error("API key, base URL, station URI, and railway URI are required");const e=(()=>{const l=new Date().getDay();return l>=1&&l<=5?"odpt.Calendar:Weekday":"odpt.Calendar:SaturdayHoliday"})(),n=new URLSearchParams({"acl:consumerKey":String(o),"odpt:railway":a,"odpt:station":t,"odpt:calendar":e}),u=`${i}odpt:StationTimetable?${n.toString()}`;return await(await x(u)).json()}async function tt(t,o,i){if(!t||!o||!i)throw new Error("API key, base URL, and railway URI are required");const a=new URLSearchParams({"acl:consumerKey":String(t),"odpt:railway":i}),e=`${o}odpt:TrainInformation?${a.toString()}`;return await(await x(e)).json()}async function At(t,o,i){if(!o||!i)throw new Error("API key and base URL are required");if(t.length===0)return[];const a=new URLSearchParams({"acl:consumerKey":String(o)});a.append("owl:sameAs",t.join(","));const e=`${i}odpt:Station?${a.toString()}`;return await(await x(e)).json()}async function Lt(t,o){if(!t||!o)throw new Error("API key and base URL are required");const i=new URLSearchParams({"acl:consumerKey":String(t)}),a=`${o}odpt:Railway?${i.toString()}`;return await(await x(a)).json()}async function Ct(t,o,i){if(!o||!i||!t)throw new Error("API key, base URL, and railway URI are required");const a=new URLSearchParams({"acl:consumerKey":String(o)});a.append("owl:sameAs",t);const e=`${i}odpt:Railway?${a.toString()}`,u=await(await x(e)).json();return u.length>0?u[0]:null}async function Ot(t,o){if(!t||!o)throw new Error("API key and base URL are required");const i=new URLSearchParams({"acl:consumerKey":String(t)}),a=`${o}odpt:RailDirection?${i.toString()}`;return await(await x(a)).json()}async function Nt(t,o){if(!t||!o)throw new Error("API key and base URL are required");const i=new URLSearchParams({"acl:consumerKey":String(t)}),a=`${o}odpt:TrainType?${i.toString()}`;return await(await x(a)).json()}function O(t){if(!t)return"N/A";if(typeof t=="string")return t;const o=t;return o.ja||o.en||"N/A"}function wt(t){const[o,i]=t.split(":").map(a=>Number(a));return o*60+i}function ut(t,o,i,a=5){return(t.find(u=>u["odpt:railDirection"]===o)?.["odpt:stationTimetableObject"]??[]).filter(u=>typeof u["odpt:departureTime"]=="string").filter(u=>wt(u["odpt:departureTime"])>=i).slice(0,a)}function Ut(...t){const o=new Set;for(const i of t)for(const a of i??[]){const e=a["odpt:destinationStation"];if(e)if(Array.isArray(e)){for(const n of e)if(n){if(typeof n=="string")o.add(n);else if(typeof n=="object"){const u=n["owl:sameAs"]||n["@id"]||n.id;u&&typeof u=="string"&&o.add(u)}}}else typeof e=="string"&&o.add(e)}return o}function mt(t=new Date){return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}function kt(t){return document.getElementById(t)}class vt{constructor(o=500,i,a){if(this.maxEntries=o,this.ttlMs=i,this.persistKeyName=a,this.map=new Map,a&&typeof localStorage<"u")try{const e=localStorage.getItem(a);if(e){const n=JSON.parse(e);for(const u of Object.keys(n)){const d=n[u];(!d.expires||d.expires>Date.now())&&this.map.set(u,d)}}}catch(e){console.warn(`Failed to restore cache from localStorage key "${a}":`,e)}}get(o){const i=this.map.get(o);if(i){if(i.expires&&i.expires<=Date.now()){this.map.delete(o);return}return this.map.delete(o),this.map.set(o,i),i.v}}set(o,i){const a=this.ttlMs?Date.now()+this.ttlMs:void 0;for(this.map.has(o)&&this.map.delete(o),this.map.set(o,{v:i,expires:a});this.map.size>this.maxEntries;){const e=this.map.keys().next().value;this.map.delete(e)}this.persistKeyName&&this.persist()}has(o){return typeof this.get(o)<"u"}persist(){if(this.persistKeyName)try{const o={};for(const[i,a]of this.map.entries())o[i]=a;localStorage.setItem(this.persistKeyName,JSON.stringify(o))}catch(o){console.warn(`Failed to persist cache to localStorage key "${this.persistKeyName}":`,o)}}keys(){return Array.from(this.map.keys())}enablePersistence(o){this.persistKeyName=o,this.persist()}}const Tt={"odpt.TrainType:Sotetsu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Sotetsu.CommuterLimitedExpress":{outline:"black",text:"red",fill:"white"},"odpt.TrainType:Sotetsu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Sotetsu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Sotetsu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Sotetsu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Odakyu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Odakyu.CommuterSemiExpress":{outline:"black",text:"yellow",fill:"black"},"odpt.TrainType:Odakyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Odakyu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Odakyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Odakyu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Odakyu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Keikyu.AccessExpress":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.AirportRapidLimitedExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Keikyu.CommuterLimitedExpress":{outline:"black",text:"red",fill:"white"},"odpt.TrainType:Keikyu.EveningWing":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Keikyu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Keikyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Keikyu.MorningWing":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Keikyu.RapidLimitedExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Keikyu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Seibu.CommuterExpress":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:Seibu.CommuterSemiExpress":{outline:"black",text:"yellow",fill:"black"},"odpt.TrainType:Seibu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Seibu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.HaijimaLiner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Seibu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Seibu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Seibu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Seibu.S-TRAIN":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Seibu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tokyu.CommuterLimitedExpress":{outline:"yellow",text:"red",fill:"white"},"odpt.TrainType:Tokyu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tokyu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.LimitedExpress":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Tokyu.S-TRAIN":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tokyu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tobu.F-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.KawagoeLimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Tobu.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:Tobu.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:Tobu.RapidExpress":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:Tobu.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:Tobu.SL-Taiju":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.SectionExpress":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:Tobu.SectionSemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.SemiExpress":{outline:"black",text:"black",fill:"gray"},"odpt.TrainType:Tobu.TH-LINER":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:Tobu.TJ-Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:JR-East.ChuoSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.CommuterRapid":{outline:"black",text:"red",fill:"black"},"odpt.TrainType:JR-East.CommuterSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.Express":{outline:"black",text:"white",fill:"red"},"odpt.TrainType:JR-East.LimitedExpress":{outline:"black",text:"black",fill:"red"},"odpt.TrainType:JR-East.Liner":{outline:"yellow",text:"white",fill:"black"},"odpt.TrainType:JR-East.Local":{outline:"black",text:"black",fill:"white"},"odpt.TrainType:JR-East.OmeSpecialRapid":{outline:"black",text:"yellow",fill:"red"},"odpt.TrainType:JR-East.Rapid":{outline:"black",text:"white",fill:"black"},"odpt.TrainType:JR-East.SpecialRapid":{outline:"black",text:"yellow",fill:"red"}};function _t(){if(document.getElementById("train-type-dynamic-styles"))return;const t=document.createElement("style");t.id="train-type-dynamic-styles";let o="";for(const[i,a]of Object.entries(Tt)){const e=ft(i);o+=`
.${e} {
  background-color: ${a.fill};
  color: ${a.text};
  border: 2px solid ${a.outline};
}
`}t.textContent=o,document.head.appendChild(t)}function ft(t){return"train-type-"+t.replace(/[:.]/g,"-")}function Ht(t){return t in Tt?ft(t):"type-LOC"}const Bt={"odpt.Railway:Odakyu.Odawara":{inbound:"新宿",outbound:"小田原"},"odpt.Railway:Keikyu.Main":{inbound:"品川",outbound:"浦賀"},"odpt.Railway:Tobu.Nikko":{inbound:"浅草",outbound:"東武日光"},"odpt.Railway:Tobu.TobuSkytree":{inbound:"浅草",outbound:"東武動物公園"},"odpt.Railway:JR-East.ChuoSobuLocal":{inbound:"三鷹",outbound:"千葉"},"odpt.Railway:Fujikyu.Fujikyu":{inbound:"大月",outbound:"河口湖"},"odpt.Railway:Keikyu.Airport":{inbound:"品川",outbound:"羽田空港"},"odpt.Railway:Keikyu.Daishi":{inbound:"京急川崎",outbound:"小島新田"},"odpt.Railway:Tokyu.DenEnToshi":{inbound:"渋谷",outbound:"中央林間"},"odpt.Railway:Tokyu.Ikegami":{inbound:"五反田",outbound:"蒲田"},"odpt.Railway:Tobu.Daishi":{inbound:"西新井",outbound:"大師前"},"odpt.Railway:Tobu.Isesaki":{inbound:"東武動物公園",outbound:"伊勢崎"},"odpt.Railway:Tobu.Kiryu":{inbound:"太田",outbound:"赤城"},"odpt.Railway:ChibaMonorail.Line2":{inbound:"千葉",outbound:"千城台"},"odpt.Railway:JR-East.Chuo":{inbound:"東京",outbound:"高尾"},"odpt.Railway:JR-East.Joban":{inbound:"上野",outbound:"水戸"},"odpt.Railway:Seibu.Toshima":{inbound:"練馬",outbound:"豊島園"},"odpt.Railway:Sotetsu.Izumino":{inbound:"二俣川",outbound:"湘南台"},"odpt.Railway:Sotetsu.Main":{inbound:"横浜",outbound:"海老名"},"odpt.Railway:Sotetsu.SotetsuShinYokohama":{inbound:"新横浜",outbound:"西谷"},"odpt.Railway:JR-Central.TokaidoShinkansen":{inbound:"東京",outbound:"新大阪"},"odpt.Railway:Odakyu.Enoshima":{inbound:"相模大野",outbound:"片瀬江ノ島"},"odpt.Railway:Odakyu.Tama":{inbound:"新百合ヶ丘",outbound:"唐木田"},"odpt.Railway:Keikyu.Kurihama":{inbound:"堀ノ内",outbound:"三崎口"},"odpt.Railway:Tokyu.Setagaya":{inbound:"三軒茶屋",outbound:"下高井戸"},"odpt.Railway:Keikyu.Zushi":{inbound:"金沢八景",outbound:"逗子・葉山"},"odpt.Railway:Seibu.Haijima":{inbound:"西武新宿",outbound:"拝島"},"odpt.Railway:Seibu.Ikebukuro":{inbound:"池袋",outbound:"飯能"},"odpt.Railway:Chichibu.Chichibu":{inbound:"羽生",outbound:"三峰口"},"odpt.Railway:Seibu.Kokubunji":{inbound:"国分寺",outbound:"東村山"},"odpt.Railway:Seibu.Sayama":{inbound:"西所沢",outbound:"西武球場前"},"odpt.Railway:Isumi.Isumi":{inbound:"大原",outbound:"上総中野"},"odpt.Railway:Seibu.SeibuChichibu":{inbound:"吾野",outbound:"西武秩父"},"odpt.Railway:Seibu.SeibuYurakucho":{inbound:"練馬",outbound:"小竹向原"},"odpt.Railway:Seibu.Seibuen":{inbound:"東村山",outbound:"西武園"},"odpt.Railway:Seibu.Shinjuku":{inbound:"西武新宿",outbound:"本川越"},"odpt.Railway:Seibu.Tamagawa":{inbound:"武蔵境",outbound:"是政"},"odpt.Railway:Seibu.Tamako":{inbound:"国分寺",outbound:"西武遊園地"},"odpt.Railway:Seibu.Yamaguchi":{inbound:"西武球場前",outbound:"西武遊園地"},"odpt.Railway:Tokyu.Kodomonokuni":{inbound:"長津田",outbound:"こどもの国"},"odpt.Railway:Tokyu.Meguro":{inbound:"目黒",outbound:"日吉"},"odpt.Railway:Tokyu.Oimachi":{inbound:"大井町",outbound:"溝の口"},"odpt.Railway:Tokyu.TokyuShinYokohama":{inbound:"新横浜",outbound:"西谷"},"odpt.Railway:JR-Central.Gotemba":{inbound:"国府津",outbound:"沼津"},"odpt.Railway:JR-Central.Minobu":{inbound:"富士",outbound:"甲府"},"odpt.Railway:Tokyu.TokyuTamagawa":{inbound:"多摩川",outbound:"蒲田"},"odpt.Railway:Choshi.Choshi":{inbound:"銚子",outbound:"外川"},"odpt.Railway:Tokyu.Toyoko":{inbound:"渋谷",outbound:"横浜"},"odpt.Railway:Tobu.Kameido":{inbound:"曳舟",outbound:"亀戸"},"odpt.Railway:Tobu.Kinugawa":{inbound:"下今市",outbound:"新藤原"},"odpt.Railway:IzuHakone.Sunzu":{inbound:"三島",outbound:"修善寺"},"odpt.Railway:Tobu.KoizumiBranch":{inbound:"館林",outbound:"西小泉"},"odpt.Railway:Tobu.Koizumi":{inbound:"太田",outbound:"西小泉"},"odpt.Railway:Enoden.Enoden":{inbound:"鎌倉",outbound:"藤沢"},"odpt.Railway:Tobu.Ogose":{inbound:"坂戸",outbound:"越生"},"odpt.Railway:Tobu.Sano":{inbound:"館林",outbound:"葛生"},"odpt.Railway:Izukyu.Izukyu":{inbound:"伊東",outbound:"伊豆急下田"},"odpt.Railway:JR-Central.Chuo":{inbound:"名古屋",outbound:"中津川"},"odpt.Railway:Tobu.TobuSkytreeBranch":{inbound:"曳舟",outbound:"亀戸"},"odpt.Railway:Tobu.TobuUrbanPark":{inbound:"大宮",outbound:"船橋"},"odpt.Railway:Tobu.Tojo":{inbound:"池袋",outbound:"寄居"},"odpt.Railway:Tobu.Utsunomiya":{inbound:"新栃木",outbound:"東武宇都宮"},"odpt.Railway:Aizu.Aizu":{inbound:"西若松",outbound:"会津高原"},"odpt.Railway:ChibaMonorail.Line1":{inbound:"千葉みなと",outbound:"県庁前"},"odpt.Railway:Hitachinaka.Minato":{inbound:"勝田",outbound:"阿字ヶ浦"},"odpt.Railway:Hokuetsu.Hokuhoku":{inbound:"六日町",outbound:"犀潟"},"odpt.Railway:Hokuso.Hokuso":{inbound:"京成高砂",outbound:"印旛日本医大"},"odpt.Railway:IzuHakone.Daiyuzan":{inbound:"小田原",outbound:"大雄山"},"odpt.Railway:JR-Central.Tokaido":{inbound:"東京",outbound:"熱海"},"odpt.Railway:JR-East.AkitaShinkansen":{inbound:"東京",outbound:"秋田"},"odpt.Railway:JR-East.Aterazawa":{inbound:"山形",outbound:"左沢"},"odpt.Railway:JR-East.BanetsuEast":{inbound:"郡山",outbound:"いわき"},"odpt.Railway:JR-East.BanetsuWest":{inbound:"郡山",outbound:"新潟"},"odpt.Railway:JR-East.Kitakami":{inbound:"北上",outbound:"横手"},"odpt.Railway:JR-East.ChuoTatsunoBranch":{inbound:"岡谷",outbound:"辰野"},"odpt.Railway:JR-East.Echigo":{inbound:"新潟",outbound:"柏崎"},"odpt.Railway:JR-East.Gono":{inbound:"東能代",outbound:"川部"},"odpt.Railway:JR-East.Hachinohe":{inbound:"八戸",outbound:"久慈"},"odpt.Railway:JR-East.Hakushin":{inbound:"新潟",outbound:"新発田"},"odpt.Railway:JR-East.Hanawa":{inbound:"大館",outbound:"好摩"},"odpt.Railway:JR-East.HokurikuShinkansen":{inbound:"東京",outbound:"金沢"},"odpt.Railway:JR-East.Iiyama":{inbound:"豊野",outbound:"越後川口"},"odpt.Railway:JR-East.Ishinomaki":{inbound:"小牛田",outbound:"女川"},"odpt.Railway:JR-East.JoetsuShinkansen":{inbound:"東京",outbound:"新潟"},"odpt.Railway:JR-East.Kamaishi":{inbound:"花巻",outbound:"釜石"},"odpt.Railway:JR-East.Karasuyama":{inbound:"宝積寺",outbound:"烏山"},"odpt.Railway:JR-East.Kesennuma":{inbound:"前谷地",outbound:"気仙沼"},"odpt.Railway:JR-East.Koumi":{inbound:"小淵沢",outbound:"小諸"},"odpt.Railway:JR-East.Mito":{inbound:"小山",outbound:"水戸"},"odpt.Railway:JR-East.Nikko":{inbound:"宇都宮",outbound:"日光"},"odpt.Railway:JR-East.Ofunato":{inbound:"一ノ関",outbound:"盛"},"odpt.Railway:JR-East.Oga":{inbound:"追分",outbound:"男鹿"},"odpt.Railway:JR-East.Oito":{inbound:"松本",outbound:"南小谷"},"odpt.Railway:JR-East.Ominato":{inbound:"野辺地",outbound:"大湊"},"odpt.Railway:JR-East.OuYamagata":{inbound:"福島",outbound:"新庄"},"odpt.Railway:JR-East.Ou":{inbound:"福島",outbound:"青森"},"odpt.Railway:JR-East.RikuEast":{inbound:"小牛田",outbound:"新庄"},"odpt.Railway:JR-East.RikuWest":{inbound:"新庄",outbound:"余目"},"odpt.Railway:JR-East.Ryomo":{inbound:"小山",outbound:"新前橋"},"odpt.Railway:JR-East.SensekiTohoku":{inbound:"仙台",outbound:"石巻"},"odpt.Railway:JR-East.Senseki":{inbound:"仙台",outbound:"石巻"},"odpt.Railway:JR-East.Senzan":{inbound:"仙台",outbound:"羽前千歳"},"odpt.Railway:JR-East.Shinetsu":{inbound:"高崎",outbound:"新潟"},"odpt.Railway:JR-East.Shinonoi":{inbound:"塩尻",outbound:"篠ノ井"},"odpt.Railway:JR-East.SuigunBranch":{inbound:"郡山",outbound:"水戸"},"odpt.Railway:JR-East.Suigun":{inbound:"水戸",outbound:"郡山"},"odpt.Railway:JR-East.Tadami":{inbound:"会津若松",outbound:"小出"},"odpt.Railway:JR-East.Tazawako":{inbound:"盛岡",outbound:"大曲"},"odpt.Railway:JR-East.TohokuShinkansen":{inbound:"東京",outbound:"新青森"},"odpt.Railway:JR-East.Tohoku":{inbound:"東京",outbound:"一ノ関"},"odpt.Railway:JR-East.Tsugaru":{inbound:"青森",outbound:"三厩"},"odpt.Railway:JR-East.Uetsu":{inbound:"新津",outbound:"秋田"},"odpt.Railway:JR-East.Yahiko":{inbound:"東三条",outbound:"弥彦"},"odpt.Railway:JR-East.Yamada":{inbound:"盛岡",outbound:"宮古"},"odpt.Railway:JR-East.YamagataShinkansen":{inbound:"東京",outbound:"新庄"},"odpt.Railway:JR-East.Yonesaka":{inbound:"米沢",outbound:"坂町"},"odpt.Railway:JR-Shikoku.SetoOhashi":{inbound:"岡山",outbound:"高松"},"odpt.Railway:JR-West.Sanin":{inbound:"京都",outbound:"幡生"},"odpt.Railway:Jomo.Jomo":{inbound:"高崎",outbound:"西桐生"},"odpt.Railway:Joshin.Joshin":{inbound:"高崎",outbound:"下仁田"},"odpt.Railway:KantoRailway.Ryugasaki":{inbound:"佐貫",outbound:"竜ヶ崎"},"odpt.Railway:KashimaRinkai.OaraiKashima":{inbound:"水戸",outbound:"鹿島神宮"},"odpt.Railway:Keisei.Chiba":{inbound:"京成津田沼",outbound:"千葉中央"},"odpt.Railway:Keisei.HigashiNarita":{inbound:"京成成田",outbound:"東成田"},"odpt.Railway:Keisei.Kanamachi":{inbound:"京成高砂",outbound:"金町"},"odpt.Railway:Keisei.Main":{inbound:"京成上野",outbound:"成田空港"},"odpt.Railway:Keisei.NaritaSkyAccess":{inbound:"京成上野",outbound:"成田空港"},"odpt.Railway:Keisei.Oshiage":{inbound:"押上",outbound:"京成高砂"},"odpt.Railway:Kominato.Kominato":{inbound:"五井",outbound:"上総中野"},"odpt.Railway:TokyoMetro.Hanzomon":{inbound:"渋谷",outbound:"押上"},"odpt.Railway:MIR.TsukubaExpress":{inbound:"秋葉原",outbound:"つくば"},"odpt.Railway:MaihamaResort.DisneyResort":{inbound:"リゾートゲートウェイ",outbound:"東京ディズニーランド"},"odpt.Railway:Minatomirai.Minatomirai":{inbound:"横浜",outbound:"元町・中華街"},"odpt.Railway:OdakyuHakone.HakoneTozan":{inbound:"小田原",outbound:"強羅"},"odpt.Railway:Ryutetsu.Nagareyama":{inbound:"馬橋",outbound:"流山"},"odpt.Railway:SaitamaRailway.SaitamaRailway":{inbound:"赤羽岩淵",outbound:"浦和美園"},"odpt.Railway:SaitamaTransit.NewShuttle":{inbound:"大宮",outbound:"内宿"},"odpt.Railway:SendaiAirportTransit.SendaiAirport":{inbound:"仙台",outbound:"仙台空港"},"odpt.Railway:SendaiMunicipal.Namboku":{inbound:"泉中央",outbound:"富沢"},"odpt.Railway:SendaiMunicipal.Tozai":{inbound:"八木山動物公園",outbound:"荒井"},"odpt.Railway:Shibayama.Shibayama":{inbound:"東成田",outbound:"芝山千代田"},"odpt.Railway:ShinKeisei.ShinKeisei":{inbound:"松戸",outbound:"京成津田沼"},"odpt.Railway:ShonanMonorail.ShonanMonorail":{inbound:"大船",outbound:"湘南江の島"},"odpt.Railway:TWR.Rinkai":{inbound:"大崎",outbound:"新木場"},"odpt.Railway:TamaMonorail.TamaMonorail":{inbound:"上北台",outbound:"多摩センター"},"odpt.Railway:Toei.Arakawa":{inbound:"早稲田",outbound:"三ノ輪橋"},"odpt.Railway:Toei.Asakusa":{inbound:"西馬込",outbound:"押上"},"odpt.Railway:Toei.Mita":{inbound:"目黒",outbound:"西高島平"},"odpt.Railway:Toei.NipporiToneri":{inbound:"日暮里",outbound:"見沼代親水公園"},"odpt.Railway:Toei.Oedo":{inbound:"光が丘",outbound:"大門"},"odpt.Railway:Toei.Shinjuku":{inbound:"新宿",outbound:"本八幡"},"odpt.Railway:TokyoMetro.Chiyoda":{inbound:"代々木上原",outbound:"取手"},"odpt.Railway:TokyoMetro.Fukutoshin":{inbound:"渋谷",outbound:"和光市"},"odpt.Railway:TokyoMetro.Ginza":{inbound:"渋谷",outbound:"浅草"},"odpt.Railway:TokyoMetro.Hibiya":{inbound:"中目黒",outbound:"北千住"},"odpt.Railway:TokyoMetro.Marunouchi":{inbound:"荻窪",outbound:"池袋"},"odpt.Railway:TokyoMetro.Namboku":{inbound:"目黒",outbound:"赤羽岩淵"},"odpt.Railway:TokyoMetro.Tozai":{inbound:"中野",outbound:"西船橋"},"odpt.Railway:TokyoMetro.Yurakucho":{inbound:"新木場",outbound:"和光市"},"odpt.Railway:TokyoMonorail.HanedaAirport":{inbound:"浜松町",outbound:"羽田空港"},"odpt.Railway:UtsunomiyaLightRail.UtsunomiyaLightRail":{inbound:"宇都宮駅東口",outbound:"芳賀・高根沢工業団地"},"odpt.Railway:WataraseKeikoku.WataraseKeikoku":{inbound:"桐生",outbound:"間藤"},"odpt.Railway:Yagan.AizuKinugawa":{inbound:"新藤原",outbound:"会津高原"},"odpt.Railway:YokohamaMunicipal.Blue":{inbound:"湘南台",outbound:"あざみ野"},"odpt.Railway:YokohamaMunicipal.Green":{inbound:"中山",outbound:"日吉"},"odpt.Railway:YokohamaSeaside.KanazawaSeaside":{inbound:"新杉田",outbound:"金沢八景"},"odpt.Railway:Yurikamome.Yurikamome":{inbound:"新橋",outbound:"豊洲"},"odpt.Railway:Keio.Inokashira":{inbound:"渋谷",outbound:"吉祥寺"},"odpt.Railway:Keio.KeioNew":{inbound:"新宿",outbound:"笹塚"},"odpt.Railway:Keio.Keio":{inbound:"新宿",outbound:"京王八王子"},"odpt.Railway:Keio.Sagamihara":{inbound:"調布",outbound:"橋本"},"odpt.Railway:KantoRailway.Joso":{inbound:"取手",outbound:"下館"},"odpt.Railway:Keio.Takao":{inbound:"北野",outbound:"高尾山口"},"odpt.Railway:ToyoRapid.ToyoRapid":{inbound:"西船橋",outbound:"東葉勝田台"},"odpt.Railway:JR-East.Agatsuma":{inbound:"渋川",outbound:"大前"},"odpt.Railway:JR-East.ChuoRapid":{inbound:"東京",outbound:"高尾"},"odpt.Railway:JR-East.Hachiko":{inbound:"八王子",outbound:"高崎"},"odpt.Railway:JR-East.Ito":{inbound:"熱海",outbound:"伊東"},"odpt.Railway:JR-East.Kawagoe":{inbound:"大宮",outbound:"高麗川"},"odpt.Railway:JR-East.Itsukaichi":{inbound:"拝島",outbound:"武蔵五日市"},"odpt.Railway:JR-East.JobanLocal":{inbound:"代々木上原",outbound:"取手"},"odpt.Railway:JR-East.JobanRapid":{inbound:"上野",outbound:"取手"},"odpt.Railway:JR-East.Joetsu":{inbound:"高崎",outbound:"長岡"},"odpt.Railway:JR-East.Kashima":{inbound:"香取",outbound:"鹿島神宮"},"odpt.Railway:JR-East.KeihinTohokuNegishi":{inbound:"大宮",outbound:"大船"},"odpt.Railway:JR-East.Keiyo":{inbound:"東京",outbound:"蘇我"},"odpt.Railway:JR-East.Kururi":{inbound:"木更津",outbound:"上総亀山"},"odpt.Railway:JR-East.Narita":{inbound:"佐倉",outbound:"銚子"},"odpt.Railway:JR-East.Musashino":{inbound:"府中本町",outbound:"西船橋"},"odpt.Railway:JR-East.NambuBranch":{inbound:"尻手",outbound:"浜川崎"},"odpt.Railway:JR-East.Nambu":{inbound:"川崎",outbound:"立川"},"odpt.Railway:JR-East.NaritaAbikoBranch":{inbound:"我孫子",outbound:"成田"},"odpt.Railway:JR-East.NaritaAirportBranch":{inbound:"成田",outbound:"成田空港"},"odpt.Railway:JR-East.Ome":{inbound:"立川",outbound:"奥多摩"},"odpt.Railway:JR-East.Sagami":{inbound:"茅ヶ崎",outbound:"橋本"},"odpt.Railway:JR-East.SaikyoKawagoe":{inbound:"大崎",outbound:"川越"},"odpt.Railway:JR-East.ShonanShinjuku":{inbound:"大宮",outbound:"大船"},"odpt.Railway:JR-East.SobuRapid":{inbound:"東京",outbound:"千葉"},"odpt.Railway:JR-East.Sobu":{inbound:"千葉",outbound:"銚子"},"odpt.Railway:JR-East.SotetsuDirect":{inbound:"新宿",outbound:"海老名"},"odpt.Railway:JR-East.Sotobo":{inbound:"千葉",outbound:"安房鴨川"},"odpt.Railway:JR-East.Takasaki":{inbound:"上野",outbound:"高崎"},"odpt.Railway:JR-East.Togane":{inbound:"成東",outbound:"大網"},"odpt.Railway:JR-East.Tokaido":{inbound:"東京",outbound:"熱海"},"odpt.Railway:JR-East.TsurumiOkawaBranch":{inbound:"浅野",outbound:"大川"},"odpt.Railway:JR-East.TsurumiUmiShibauraBranch":{inbound:"浅野",outbound:"海芝浦"},"odpt.Railway:JR-East.Tsurumi":{inbound:"鶴見",outbound:"扇町"},"odpt.Railway:JR-East.Uchibo":{inbound:"蘇我",outbound:"安房鴨川"},"odpt.Railway:JR-East.Utsunomiya":{inbound:"上野",outbound:"黒磯"},"odpt.Railway:JR-East.Yamanote":{inbound:"内回り",outbound:"外回り"},"odpt.Railway:JR-East.Yokohama":{inbound:"東神奈川",outbound:"八王子"},"odpt.Railway:JR-East.Yokosuka":{inbound:"東京",outbound:"久里浜"}};let ht=[],K=null,_=null,H=null,ot="渋谷・副都心線方面",at="横浜・元町中華街方面";const A=Bt,D={},B=new Map;let Et=[];const M=new vt(500);function Yt(){return _||"odpt.RailDirection:Inbound"}function Dt(){return H||"odpt.RailDirection:Outbound"}function Pt(){try{const t=K?K["owl:sameAs"]||K["@id"]:null;if(t&&A[t]&&A[t].inbound)return A[t].inbound}catch{}return ot}function jt(){try{const t=K?K["owl:sameAs"]||K["@id"]:null;if(t&&A[t]&&A[t].outbound)return A[t].outbound}catch{}return at}function dt(){return ht}function zt(t){ht=t}function I(){return Et}async function $t(t,o){try{const i=await Ot(t,o);for(const a of i){const e=a["owl:sameAs"]||a["@id"],n=O(a["dc:title"]);e&&typeof e=="string"&&B.set(e,n)}}catch(i){console.warn("Failed to load direction names:",i)}}async function Ft(t,o){try{const i=await Nt(t,o);for(const a of i){const e=a["owl:sameAs"]||a["@id"];if(!e||typeof e!="string")continue;const n=O(a["dc:title"]);if(!n)continue;const u=Ht(e);D[e]={name:n,class:u}}console.log(`Loaded ${Object.keys(D).length} train types`)}catch(i){console.warn("Failed to load train types:",i)}}async function F(t,o,i){try{const a=await Ct(t,o,i);if(!a){console.warn("Railway not found:",t);return}K=a,_=a["odpt:descendingRailDirection"]||"odpt.RailDirection:Inbound",H=a["odpt:ascendingRailDirection"]||"odpt.RailDirection:Outbound",_&&B.has(_)&&(ot=B.get(_)||ot),H&&B.has(H)&&(at=B.get(H)||at),Et=(a["odpt:stationOrder"]||[]).map(u=>{const d=u["odpt:station"]||"",l=u["odpt:stationTitle"],s=O(l),R=u["odpt:index"]||-1;return{name:s,uri:d,index:R}}).filter(u=>u.uri&&u.name!=="N/A").sort((u,d)=>u.index-d.index);const n=O(a["dc:title"]||a["odpt:railwayTitle"]);Wo(`${n} 発車案内板`)}catch(a){console.warn("Failed to load railway metadata:",a)}}async function Wt(t,o,...i){const a=Ut(...i),e=Array.from(a).filter(n=>!M.has(n));if(e.length!==0)try{const n=await At(e,t,o);for(const u of n){const d=u["owl:sameAs"]||u["@id"]||u.id,l=O(u["dc:title"]||u["odpt:stationTitle"]||u.title);d&&typeof d=="string"&&M.set(d,l)}for(const u of e)M.has(u)||M.set(u,u)}catch(n){console.warn("Failed to fetch station names for destinations:",n)}}const W={東京都:["odpt.Railway:Odakyu.Odawara","odpt.Railway:Keikyu.Main","odpt.Railway:Tobu.TobuSkytree","odpt.Railway:JR-East.ChuoSobuLocal","odpt.Railway:Keikyu.Airport","odpt.Railway:Tokyu.DenEnToshi","odpt.Railway:Tokyu.Ikegami","odpt.Railway:Tobu.Daishi","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.Joban","odpt.Railway:Seibu.Toshima","odpt.Railway:Odakyu.Tama","odpt.Railway:Tokyu.Setagaya","odpt.Railway:Seibu.Haijima","odpt.Railway:Seibu.Ikebukuro","odpt.Railway:Seibu.Kokubunji","odpt.Railway:Seibu.SeibuYurakucho","odpt.Railway:Seibu.Seibuen","odpt.Railway:Seibu.Shinjuku","odpt.Railway:Seibu.Tamagawa","odpt.Railway:Seibu.Tamako","odpt.Railway:Seibu.Yamaguchi","odpt.Railway:Tokyu.Kodomonokuni","odpt.Railway:Tokyu.Meguro","odpt.Railway:Tokyu.Oimachi","odpt.Railway:Tokyu.TokyuShinYokohama","odpt.Railway:Tokyu.TokyuTamagawa","odpt.Railway:Tokyu.Toyoko","odpt.Railway:Tobu.Kameido","odpt.Railway:Tobu.TobuSkytreeBranch","odpt.Railway:Hokuso.Hokuso","odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.JoetsuShinkansen","odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.Ou","odpt.Railway:Keisei.Main","odpt.Railway:Keisei.NaritaSkyAccess","odpt.Railway:Keisei.Oshiage","odpt.Railway:TokyoMetro.Hanzomon","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:TokyoMonorail.HanedaAirport","odpt.Railway:TWR.Rinkai","odpt.Railway:TamaMonorail.TamaMonorail","odpt.Railway:Toei.Arakawa","odpt.Railway:Toei.Asakusa","odpt.Railway:Toei.Mita","odpt.Railway:Toei.NipporiToneri","odpt.Railway:Toei.Oedo","odpt.Railway:Toei.Shinjuku","odpt.Railway:TokyoMetro.Chiyoda","odpt.Railway:TokyoMetro.Fukutoshin","odpt.Railway:TokyoMetro.Ginza","odpt.Railway:TokyoMetro.Hibiya","odpt.Railway:TokyoMetro.Marunouchi","odpt.Railway:TokyoMetro.Namboku","odpt.Railway:TokyoMetro.Tozai","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:Yurikamome.Yurikamome","odpt.Railway:Keio.Inokashira","odpt.Railway:Keio.KeioNew","odpt.Railway:Keio.Keio","odpt.Railway:Keio.Sagamihara","odpt.Railway:Keio.Takao","odpt.Railway:JR-East.ChuoRapid","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.Kawagoe","odpt.Railway:JR-East.Itsukaichi","odpt.Railway:JR-East.JobanLocal","odpt.Railway:JR-East.JobanRapid","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.Keiyo","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.Nambu","odpt.Railway:JR-East.Ome","odpt.Railway:JR-East.SaikyoKawagoe","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.SobuRapid","odpt.Railway:JR-East.SotetsuDirect","odpt.Railway:JR-East.Tokaido","odpt.Railway:JR-East.Utsunomiya","odpt.Railway:JR-East.Yamanote","odpt.Railway:JR-East.Yokohama","odpt.Railway:JR-East.Yokosuka"],神奈川県:["odpt.Railway:Odakyu.Odawara","odpt.Railway:Keikyu.Main","odpt.Railway:Keikyu.Airport","odpt.Railway:Keikyu.Daishi","odpt.Railway:Tokyu.DenEnToshi","odpt.Railway:Tokyu.Ikegami","odpt.Railway:Sotetsu.Izumino","odpt.Railway:Sotetsu.Main","odpt.Railway:Sotetsu.SotetsuShinYokohama","odpt.Railway:JR-Central.TokaidoShinkansen","odpt.Railway:Odakyu.Enoshima","odpt.Railway:Odakyu.Tama","odpt.Railway:Keikyu.Kurihama","odpt.Railway:Keikyu.Zushi","odpt.Railway:Tokyu.Kodomonokuni","odpt.Railway:Tokyu.Meguro","odpt.Railway:Tokyu.Oimachi","odpt.Railway:Tokyu.TokyuShinYokohama","odpt.Railway:Tokyu.TokyuTamagawa","odpt.Railway:Choshi.Choshi","odpt.Railway:Tokyu.Toyoko","odpt.Railway:Enoden.Enoden","odpt.Railway:JR-Central.Tokaido","odpt.Railway:Minatomirai.Minatomirai","odpt.Railway:OdakyuHakone.HakoneTozan","odpt.Railway:ShonanMonorail.ShonanMonorail","odpt.Railway:JR-East.Tokaido","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.NambuBranch","odpt.Railway:JR-East.Nambu","odpt.Railway:JR-East.Sagami","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.SotetsuDirect","odpt.Railway:JR-East.TsurumiOkawaBranch","odpt.Railway:JR-East.TsurumiUmiShibauraBranch","odpt.Railway:JR-East.Tsurumi","odpt.Railway:JR-East.Yokohama","odpt.Railway:JR-East.Yokosuka","odpt.Railway:YokohamaMunicipal.Blue","odpt.Railway:YokohamaMunicipal.Green","odpt.Railway:YokohamaSeaside.KanazawaSeaside"],千葉県:["odpt.Railway:JR-East.ChuoSobuLocal","odpt.Railway:ChibaMonorail.Line2","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:Isumi.Isumi","odpt.Railway:Choshi.Choshi","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:ChibaMonorail.Line1","odpt.Railway:Hokuso.Hokuso","odpt.Railway:Keisei.Chiba","odpt.Railway:Keisei.HigashiNarita","odpt.Railway:Keisei.Kanamachi","odpt.Railway:Keisei.Main","odpt.Railway:Keisei.NaritaSkyAccess","odpt.Railway:Keisei.Oshiage","odpt.Railway:Kominato.Kominato","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:MaihamaResort.DisneyResort","odpt.Railway:Ryutetsu.Nagareyama","odpt.Railway:Shibayama.Shibayama","odpt.Railway:ShinKeisei.ShinKeisei","odpt.Railway:TWR.Rinkai","odpt.Railway:Toei.Shinjuku","odpt.Railway:TokyoMetro.Tozai","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:ToyoRapid.ToyoRapid","odpt.Railway:JR-East.Keiyo","odpt.Railway:JR-East.Kashima","odpt.Railway:JR-East.Kururi","odpt.Railway:JR-East.Narita","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.NaritaAbikoBranch","odpt.Railway:JR-East.NaritaAirportBranch","odpt.Railway:JR-East.SobuRapid","odpt.Railway:JR-East.Sobu","odpt.Railway:JR-East.Sotobo","odpt.Railway:JR-East.Togane","odpt.Railway:JR-East.Uchibo"],埼玉県:["odpt.Railway:Tobu.TobuSkytree","odpt.Railway:Tobu.Daishi","odpt.Railway:Tobu.TobuUrbanPark","odpt.Railway:Tobu.Tojo","odpt.Railway:Tobu.Ogose","odpt.Railway:Chichibu.Chichibu","odpt.Railway:Seibu.Haijima","odpt.Railway:Seibu.Ikebukuro","odpt.Railway:Seibu.Sayama","odpt.Railway:Seibu.SeibuChichibu","odpt.Railway:Seibu.SeibuYurakucho","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:SaitamaRailway.SaitamaRailway","odpt.Railway:SaitamaTransit.NewShuttle","odpt.Railway:TokyoMetro.Fukutoshin","odpt.Railway:TokyoMetro.Namboku","odpt.Railway:TokyoMetro.Yurakucho","odpt.Railway:JR-East.Kawagoe","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.KeihinTohokuNegishi","odpt.Railway:JR-East.Musashino","odpt.Railway:JR-East.SaikyoKawagoe","odpt.Railway:JR-East.ShonanShinjuku","odpt.Railway:JR-East.Takasaki","odpt.Railway:JR-East.Utsunomiya"],群馬県:["odpt.Railway:Tobu.Kiryu","odpt.Railway:Tobu.Isesaki","odpt.Railway:Tobu.KoizumiBranch","odpt.Railway:Tobu.Koizumi","odpt.Railway:Jomo.Jomo","odpt.Railway:Joshin.Joshin","odpt.Railway:WataraseKeikoku.WataraseKeikoku","odpt.Railway:JR-East.Agatsuma","odpt.Railway:JR-East.Hachiko","odpt.Railway:JR-East.Joetsu","odpt.Railway:JR-East.Ryomo","odpt.Railway:JR-East.Takasaki"],栃木県:["odpt.Railway:Tobu.Nikko","odpt.Railway:Tobu.Kinugawa","odpt.Railway:Tobu.Sano","odpt.Railway:Tobu.Utsunomiya","odpt.Railway:Yagan.AizuKinugawa","odpt.Railway:JR-East.Nikko","odpt.Railway:JR-East.Ryomo","odpt.Railway:JR-East.Utsunomiya","odpt.Railway:JR-East.Karasuyama","odpt.Railway:JR-East.Mito","odpt.Railway:JR-East.Tohoku","odpt.Railway:UtsunomiyaLightRail.UtsunomiyaLightRail"],茨城県:["odpt.Railway:JR-East.Joban","odpt.Railway:JR-East.Mito","odpt.Railway:JR-East.SuigunBranch","odpt.Railway:JR-East.Suigun","odpt.Railway:Hitachinaka.Minato","odpt.Railway:KantoRailway.Ryugasaki","odpt.Railway:KantoRailway.Joso","odpt.Railway:KashimaRinkai.OaraiKashima","odpt.Railway:MIR.TsukubaExpress","odpt.Railway:TokyoMetro.Chiyoda","odpt.Railway:JR-East.JobanLocal","odpt.Railway:JR-East.JobanRapid","odpt.Railway:JR-East.Kashima"],山梨県:["odpt.Railway:Fujikyu.Fujikyu","odpt.Railway:JR-Central.Minobu","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.ChuoRapid","odpt.Railway:JR-East.Koumi","odpt.Railway:JR-East.Oito"],静岡県:["odpt.Railway:JR-Central.TokaidoShinkansen","odpt.Railway:JR-Central.Gotemba","odpt.Railway:JR-Central.Minobu","odpt.Railway:JR-Central.Tokaido","odpt.Railway:IzuHakone.Sunzu","odpt.Railway:IzuHakone.Daiyuzan","odpt.Railway:Izukyu.Izukyu","odpt.Railway:JR-East.Ito"],宮城県:["odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.Tohoku","odpt.Railway:JR-East.SensekiTohoku","odpt.Railway:JR-East.Senseki","odpt.Railway:JR-East.Senzan","odpt.Railway:JR-East.Ishinomaki","odpt.Railway:SendaiAirportTransit.SendaiAirport","odpt.Railway:SendaiMunicipal.Namboku","odpt.Railway:SendaiMunicipal.Tozai"],福島県:["odpt.Railway:Aizu.Aizu","odpt.Railway:JR-East.TohokuShinkansen","odpt.Railway:JR-East.YamagataShinkansen","odpt.Railway:JR-East.Tohoku","odpt.Railway:JR-East.OuYamagata","odpt.Railway:JR-East.Ou","odpt.Railway:JR-East.BanetsuEast","odpt.Railway:JR-East.BanetsuWest","odpt.Railway:JR-East.Tadami","odpt.Railway:JR-East.SuigunBranch"],新潟県:["odpt.Railway:JR-East.JoetsuShinkansen","odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.Joetsu","odpt.Railway:JR-East.Shinetsu","odpt.Railway:JR-East.Uetsu","odpt.Railway:JR-East.Echigo","odpt.Railway:JR-East.Hakushin","odpt.Railway:JR-East.Iiyama","odpt.Railway:JR-East.Yahiko","odpt.Railway:JR-East.Yonesaka","odpt.Railway:Hokuetsu.Hokuhoku"],長野県:["odpt.Railway:JR-East.HokurikuShinkansen","odpt.Railway:JR-East.Chuo","odpt.Railway:JR-East.ChuoTatsunoBranch","odpt.Railway:JR-East.Koumi","odpt.Railway:JR-East.Iiyama","odpt.Railway:JR-East.Oito","odpt.Railway:JR-East.Shinetsu","odpt.Railway:JR-East.Shinonoi"]},Gt=["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"],qt="東京メトロ",Vt="都営",Zt="東急",Xt="小田急",Qt="京王",to="西武",oo="東武",ao="京成",io="京急",no="相鉄",eo="横浜市営",uo="千葉都市モノレール",lo="富士急行",so="秩父鉄道",ro="いすみ鉄道",yo="銚子電気鉄道",po="伊豆箱根鉄道",co="伊豆急行",Ro="江ノ島電鉄",bo="会津鉄道",wo="ひたちなか海浜鉄道",mo="北越急行",ko="北総鉄道",To="上毛電気鉄道",fo="上信電鉄",ho="関東鉄道",Eo="鹿島臨海鉄道",So="小湊鉄道",go="首都圏新都市鉄道 (つくばエクスプレス)",Jo="舞浜リゾートライン",Io="横浜高速鉄道",Ko="小田急箱根",xo="流鉄",Mo="埼玉高速鉄道",Ao="埼玉新都市交通",Lo="仙台空港鉄道",Co="仙台市営",Oo="芝山鉄道",No="新京成電鉄",Uo="湘南モノレール",vo="東京臨海高速鉄道",_o="多摩都市モノレール",Ho="東葉高速鉄道",Bo="宇都宮ライトレール",Yo="わたらせ渓谷鐵道",Do="野岩鉄道",Po="横浜シーサイドライン",jo="ゆりかもめ",zo={"JR-East":"JR東日本","JR-Central":"JR東海","JR-Shikoku":"JR四国","JR-West":"JR西日本",TokyoMetro:qt,Toei:Vt,Tokyu:Zt,Odakyu:Xt,Keio:Qt,Seibu:to,Tobu:oo,Keisei:ao,Keikyu:io,Sotetsu:no,YokohamaMunicipal:eo,ChibaMonorail:uo,Fujikyu:lo,Chichibu:so,Isumi:ro,Choshi:yo,IzuHakone:po,Izukyu:co,Enoden:Ro,Aizu:bo,Hitachinaka:wo,Hokuetsu:mo,Hokuso:ko,Jomo:To,Joshin:fo,KantoRailway:ho,KashimaRinkai:Eo,Kominato:So,MIR:go,MaihamaResort:Jo,Minatomirai:Io,OdakyuHakone:Ko,Ryutetsu:xo,SaitamaRailway:Mo,SaitamaTransit:Ao,SendaiAirportTransit:Lo,SendaiMunicipal:Co,Shibayama:Oo,ShinKeisei:No,ShonanMonorail:Uo,TWR:vo,TamaMonorail:_o,ToyoRapid:Ho,UtsunomiyaLightRail:Bo,WataraseKeikoku:Yo,Yagan:Do,YokohamaSeaside:Po,Yurikamome:jo},L="t2board_railway_uri",C="t2board_station_uri",it="t2board_api_key",St="t2board_recent_railways",U="t2board_prefecture",$o=5,Fo=15e3;let lt=!1,st=!1;function Wo(t){document.title=t}function Go(t){const o=document.getElementById("station-header");o&&(o.textContent=t||"")}function qo(){const t=document.getElementById("departures-inbound"),o=document.getElementById("departures-outbound"),i='<p class="text-center text-2xl pt-8">時刻表を取得中...</p>';t&&(t.innerHTML=i),o&&(o.innerHTML=i)}function Vo(t,o){const i=document.getElementById("direction-inbound-header"),a=document.getElementById("direction-outbound-header");i&&(i.textContent=t),a&&(a.textContent=o)}function rt(t,o,i,a){const e=document.getElementById(`departures-${t}`);if(e){if(o.length===0){e.innerHTML='<p class="text-center text-2xl pt-8">本日の発車予定はありません。</p>';return}e.innerHTML=o.map(n=>{const u=n["odpt:departureTime"],d=n["odpt:trainType"]||"";let l="N/A";const s=n["odpt:destinationStation"];if(Array.isArray(s)&&s.length>0){const w=s[0];if(typeof w=="string")l=i.get(w)||w;else if(w&&typeof w=="object"){const h=w;if(l=h["dc:title"]||h.title||"N/A",(!l||l==="N/A")&&h["owl:sameAs"]){const E=h["owl:sameAs"];typeof E=="string"&&(l=i.get(E)||E)}}}else typeof s=="string"&&(l=i.get(s)||s);const R=a[d]||{name:"不明",class:"type-LOC"};return`
        <div class="train-row items-center justify-between">
          <div class="minutes-col text-center" data-departure="${u||""}">--</div>
          <div class="time-col text-center">${u||"--"}</div>
          <div class="flex justify-center items-center">
            <span class="train-type-badge ${R.class}">${R.name}</span>
          </div>
          <div class="destination-text">${l}</div>
        </div>`}).join("")}}let G;function Zo(t){const[o,i]=(t||"").split(":"),a=Number(o||0),e=Number(i||0);return a*3600+e*60}function yt(){const t=Array.from(document.querySelectorAll("[data-departure]")),o=new Date,i=o.getHours()*3600+o.getMinutes()*60+o.getSeconds();for(const a of t){const e=a.getAttribute("data-departure")||"",u=Zo(e)-i;if(u<=0)a.textContent="出発";else if(u<=60)a.textContent="到着";else{const d=Math.ceil(u/60);a.textContent=`${d}分`}}}function Xo(t=Fo){yt(),typeof G<"u"&&clearInterval(G),G=window.setInterval(yt,t)}function pt(){const t=document.getElementById("time-header");t&&(t.textContent=mt())}function ct(t,o){const i=localStorage.getItem(C),a=t.find(n=>n.name===o)||t[0];let e=a;if(i){const n=t.find(u=>u.uri===i);n&&(e=n)}else t.length>0&&(e=a||t[0]);return e}function gt(){try{const t=localStorage.getItem(St);return t?JSON.parse(t):[]}catch{return[]}}function Qo(t){try{let o=gt();o=o.filter(i=>i!==t),o.unshift(t),o=o.slice(0,$o),localStorage.setItem(St,JSON.stringify(o))}catch(o){console.warn("Failed to save recent railway:",o)}}function ta(t,o){const i=localStorage.getItem(L),a=t.find(n=>n.uri===o)||t[0];let e=a;if(i){const n=t.find(u=>u.uri===i);n&&(e=n)}else t.length>0&&(e=a||t[0]);return e}function oa(t){if(!t)return"その他";const o=t.split(":"),i=o.length>1?o[1]:t;return zo[i]||i}function aa(t,o,i,a,e,n,u){const d=document.getElementById("config-modal"),l=document.getElementById("railway-select"),s=document.getElementById("station-select"),R=document.getElementById("prefecture-select");if(!d||!l||!s||!R)return;function w(S,k){if(!l)return;let c="";const r=gt();let b=null;k&&W[k]&&(b=new Set(W[k]));const T=r.map(y=>t.find(m=>m.uri===y)).filter(y=>y!==void 0).filter(y=>b?b.has(y.uri):!0);if(T.length>0){c+='<optgroup label="最近使用した路線">';for(const y of T)c+=`<option value="${y.uri}" ${y.uri===S?"selected":""}>${y.name}</option>`;c+="</optgroup>"}const g=new Map;for(const y of t){if(b&&!b.has(y.uri))continue;const m=oa(y.operator);g.has(m)||g.set(m,[]),g.get(m).push(y)}const z=Array.from(g.keys()).sort((y,m)=>y.localeCompare(m,"ja"));for(const y of z){const m=g.get(y);c+=`<optgroup label="${y}">`;for(const $ of m)c+=`<option value="${$.uri}" ${$.uri===S?"selected":""}>${$.name}</option>`;c+="</optgroup>"}l.innerHTML=c}function h(S){if(!R)return;const k=new Set(Object.keys(W)),c=Gt.filter(r=>k.has(r));R.innerHTML=c.map(r=>`<option value="${r}" ${r===S?"selected":""}>${r}</option>`).join("")}function E(S){if(!s)return;const k=I();s.innerHTML=k.map(c=>`<option value="${c.uri}" ${c.uri===S?"selected":""}>${c.name}</option>`).join("")}const et=localStorage.getItem(U)||"東京都";h(et),w(i,et),E(a),st||(document.getElementById("settings-button")?.addEventListener("click",()=>{const r=localStorage.getItem(L),b=localStorage.getItem(C),T=localStorage.getItem(U)||"東京都";h(T),w(r,T),E(b),ia()}),document.getElementById("close-modal")?.addEventListener("click",()=>{q()}),l?.addEventListener("change",async()=>{if(!l)return;const r=l.value;if(s&&(s.innerHTML="<option>駅を読込中...</option>",s.disabled=!0),u)try{await u(r),E(null)}catch(b){console.error("Failed to load stations:",b),s&&(s.innerHTML="<option>駅の読込に失敗しました</option>")}finally{s&&(s.disabled=!1)}}),R?.addEventListener("change",async()=>{if(!R)return;const r=R.value;try{localStorage.setItem(U,r)}catch{}w(null,r)}),document.getElementById("save-settings")?.addEventListener("click",()=>{if(!l||!s||!R)return;const r=l.value,b=s.value,T=R.value,g=localStorage.getItem(L),z=localStorage.getItem(C),y=localStorage.getItem(U);localStorage.setItem(U,T),localStorage.setItem(L,r),localStorage.setItem(C,b),Qo(r),T!==y||r!==g?e(r):b!==z&&n(b),q()}),d.addEventListener("click",r=>{r.target===d&&q()}),st=!0)}function Rt(t,o){const i=document.getElementById("api-key-modal"),a=document.getElementById("api-key-input");if(!(!i||!a)&&(a.value=t||"",!lt)){const e=document.getElementById("save-api-key"),n=document.getElementById("close-api-key");e?.addEventListener("click",()=>{const u=a.value?a.value.trim():null;u?localStorage.setItem(it,u):localStorage.removeItem(it),o(u),V()}),n?.addEventListener("click",()=>V()),i.addEventListener("click",u=>{u.target===i&&V()}),lt=!0}}function ia(){const t=document.getElementById("config-modal");t&&(t.classList.remove("hidden"),t.classList.add("flex","opacity-100"))}function q(){const t=document.getElementById("config-modal");t&&(t.classList.remove("flex","opacity-100"),t.classList.add("hidden"))}function Jt(){const t=document.getElementById("api-key-modal");t&&(t.classList.remove("hidden"),t.classList.add("flex","opacity-100"))}function V(){const t=document.getElementById("api-key-modal");t&&(t.classList.remove("flex","opacity-100"),t.classList.add("hidden"))}function It(t,o="info"){const i=document.getElementById("status-banner");i&&(i.classList.remove("hidden"),i.classList.remove("bg-red-100","bg-yellow-100","bg-blue-100","text-red-800"),o==="error"?i.classList.add("bg-red-100","text-red-800"):o==="warn"?i.classList.add("bg-yellow-100"):i.classList.add("bg-blue-100"),i.textContent=t)}function na(){const t=document.getElementById("status-banner");t&&(t.classList.add("hidden"),t.textContent="")}let j=null,Kt="https://api-challenge.odpt.org/api/v4/",xt="odpt.Railway:Tokyu.Toyoko",nt="武蔵小杉 (TY11)";const ea=3e5,ua=3e5,da=1e4;function bt(t){j=t}function f(){return j}function N(){return Kt}async function la(){try{const t=await fetch("./config.json",{cache:"no-store"});if(!t.ok)return;const o=await t.json();o?.ODPT_API_KEY&&(j=o.ODPT_API_KEY),o?.DEFAULT_RAILWAY&&(xt=o.DEFAULT_RAILWAY),o?.DEFAULT_STATION_NAME&&(nt=o.DEFAULT_STATION_NAME),o?.API_BASE_URL&&(Kt=o.API_BASE_URL)}catch(t){const o=t instanceof Error?t:new Error(String(t));console.warn("Failed to load ./config.json:",o.message)}}async function sa(){await la();try{const t=localStorage.getItem(it);t&&(j=t)}catch{}}let p={railwayUri:null,stationUri:null,stationName:null},Z,X;function J(){return p}function v(t){p=t}function ra(){if(!f()){const a=document.getElementById("departures-inbound"),e=document.getElementById("departures-outbound"),n='<p class="text-center text-red-500 text-2xl pt-8">エラー: config.json に ODPT_API_KEY を設定してください。</p>';return a&&(a.innerHTML=n),e&&(e.innerHTML=n),null}const i=I().find(a=>a.uri===p.stationUri);if(!i||!p.railwayUri){const a=kt("station-header");return a&&(a.textContent="エラー: 駅または路線が選択されていません"),null}return i}async function Y(t){const o=f();if(!o)return!1;let i=[];try{i=await Mt(t,o,N(),p.railwayUri)}catch(d){return console.error("Failed to fetch timetable:",d),It("API エラーが発生しました。API キーを確認してください。","error"),Jt(),!1}const e=wt(mt(new Date)),n=ut(i,Yt(),e),u=ut(i,Dt(),e);return await Wt(o,N(),n,u),rt("inbound",n,M,D),rt("outbound",u,M,D),Xo(),!0}async function ya(){const t=f();if(t)try{p.railwayUri&&(await tt(t,N(),p.railwayUri),na())}catch(o){console.warn("Failed to fetch status:",o),It("運行情報取得でエラーが発生しました。API キーを確認してください。","warn")}}function pa(t){typeof Z<"u"&&clearInterval(Z),typeof X<"u"&&clearInterval(X),Z=window.setInterval(async()=>{try{const o=localStorage.getItem(C);o?await Y(o):await Y(p.stationUri)}catch{p.stationUri&&await Y(p.stationUri)}},ea),X=window.setInterval(async()=>{const o=f();if(o)try{const a=localStorage.getItem(L)||p.railwayUri;a&&await tt(o,N(),a)}catch{p.railwayUri&&await tt(o,N(),p.railwayUri)}},ua),window.setInterval(pt,da),pt()}async function Q(){try{const i=localStorage.getItem(L),a=localStorage.getItem(C);if(i&&(p.railwayUri=i),a){p.stationUri=a;const n=I().find(u=>u.uri===a);n&&(p.stationName=n.name)}}catch(i){console.warn("Failed to load config from localStorage:",i)}const t=ra();!t||(Go(t.name),qo(),Vo(Pt(),jt()),!await Y(t.uri))||(await ya(),pa(t.uri))}async function P(){try{await sa()}catch(n){const u=n instanceof Error?n:new Error(String(n));console.warn("Error loading local config:",u.message)}if(_t(),!f()){Rt(f(),n=>{n&&bt(n),P()}),Jt();return}const t=String(f()),o=N();await $t(t,o),await Ft(t,o);try{const u=(await Lt(t,o)).filter(d=>d["@type"]==="odpt:Railway").map(d=>{const l=O(d["dc:title"]||d["odpt:railwayTitle"]),s=d["odpt:operator"]||"";return{uri:d["owl:sameAs"]||d["@id"]||"",name:l,operator:s}}).filter(d=>d.uri&&d.name).sort((d,l)=>d.name.localeCompare(l.name,"ja"));zt(u)}catch(n){const u=n instanceof Error?n:new Error(String(n));console.error("Error fetching railway list:",u.message);const d=kt("station-header");d&&(d.textContent="エラー: 路線リスト取得失敗")}const i=ta(dt(),xt);let a=J();i&&(a.railwayUri=i.uri,v(a),await F(i.uri,t,o));const e=ct(I(),nt);e&&(a=J(),a.stationUri=e.uri,a.stationName=e.name,v(a)),Rt(f(),n=>{n&&bt(n),P()}),aa(dt(),I(),J().railwayUri,J().stationUri,async n=>{let u=J();u.railwayUri=n,v(u),await F(n,t,o);const d=ct(I(),nt);d&&(u=J(),u.stationUri=d.uri,u.stationName=d.name,v(u)),Q()},n=>{const u=I().find(l=>l.uri===n),d=J();d.stationUri=n,d.stationName=u?u.name:null,v(d),Q()},async n=>{await F(n,t,o)}),Q()}window.initializeBoard=P;window.onload=P;
